<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STEM+ Quiz Championship</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ </text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&family=Cinzel:wght@400;600;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#060a12;--panel:#0b1422;--panel2:#0f1a2e;--border:#1a2d4a;--border2:#223355;
  --accent:#00d4ff;--accent2:#ff6b35;--correct:#00ff88;--wrong:#ff2d55;
  --text:#e8f4ff;--muted:#4a6080;--muted2:#324860;
  --glow:0 0 24px rgba(0,212,255,.45);--glow2:0 0 24px rgba(255,107,53,.4);
  --gold:#f0c040;--silver:#c8d0e0;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{font-family:'Rajdhani',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;align-items:flex-start;justify-content:center;overflow-x:hidden;position:relative;padding:12px 0 40px;}

/* â”€â”€ ANIMATED BG â”€â”€ */
.bg-grid{position:fixed;inset:0;pointer-events:none;background-image:linear-gradient(rgba(0,212,255,.025) 1px,transparent 1px),linear-gradient(90deg,rgba(0,212,255,.025) 1px,transparent 1px);background-size:44px 44px;animation:gridMove 24s linear infinite;}
.bg-glow{position:fixed;inset:0;pointer-events:none;background:radial-gradient(ellipse at 15% 50%,rgba(0,212,255,.06) 0%,transparent 55%),radial-gradient(ellipse at 85% 50%,rgba(255,107,53,.06) 0%,transparent 55%);}
.bg-stars{position:fixed;inset:0;pointer-events:none;overflow:hidden;}
@keyframes gridMove{0%{transform:translateY(0)}100%{transform:translateY(44px)}}
@keyframes twinkle{0%,100%{opacity:.2}50%{opacity:.8}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}

/* â”€â”€ LAYOUT â”€â”€ */
#app{position:relative;z-index:10;width:100%;max-width:820px;padding:0 16px;}
.screen{display:none;}.screen.active{display:block;animation:fadeUp .35s ease-out;}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€ ONLINE STATUS BAR â”€â”€ */
#status-bar{
position:fixed;top:0;left:0;right:0;z-index:100;
background:rgba(6,10,18,.9);backdrop-filter:blur(12px);
border-bottom:1px solid var(â€“border);
padding:8px 20px;display:flex;align-items:center;justify-content:space-between;
}
.status-left{display:flex;align-items:center;gap:10px;}
.status-brand{font-family:â€˜Orbitronâ€™,monospace;font-size:.68rem;letter-spacing:3px;color:var(â€“muted);text-transform:uppercase;}
.online-badge{display:flex;align-items:center;gap:6px;padding:3px 10px;border-radius:20px;font-size:.65rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;transition:all .4s;}
.online-badge.online{background:rgba(0,255,136,.1);border:1px solid rgba(0,255,136,.3);color:var(â€“correct);}
.online-badge.offline{background:rgba(255,45,85,.1);border:1px solid rgba(255,45,85,.3);color:var(â€“wrong);}
.online-dot{width:7px;height:7px;border-radius:50%;animation:pulse-dot 2s infinite;}
.online-badge.online .online-dot{background:var(â€“correct);box-shadow:0 0 6px var(â€“correct);}
.online-badge.offline .online-dot{background:var(â€“wrong);box-shadow:0 0 6px var(â€“wrong);animation:none;}
@keyframes pulse-dot{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.4);opacity:.6}}
.status-right{display:flex;align-items:center;gap:14px;}
.status-icon{display:flex;align-items:center;gap:5px;font-size:.65rem;color:var(â€“muted);letter-spacing:1px;}
.status-icon svg{width:14px;height:14px;flex-shrink:0;}
#app{margin-top:44px;}

/* â”€â”€ NAV BAR â”€â”€ */
.nav-bar{
display:flex;align-items:center;gap:10px;margin-bottom:14px;
}
.nav-btn{
display:flex;align-items:center;gap:6px;padding:7px 14px;
font-family:â€˜Orbitronâ€™,monospace;font-size:.65rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;
border:1px solid var(â€“border);border-radius:3px;background:rgba(255,255,255,.02);color:var(â€“muted);
cursor:pointer;transition:all .2s;
}
.nav-btn:hover{color:var(â€“text);border-color:var(â€“accent);background:rgba(0,212,255,.06);}
.nav-btn svg{width:13px;height:13px;flex-shrink:0;}
.nav-spacer{flex:1;}
.nav-quit{border-color:rgba(255,45,85,.3);color:rgba(255,45,85,.7);}
.nav-quit:hover{border-color:var(â€“wrong);color:var(â€“wrong);background:rgba(255,45,85,.08);}

/* â”€â”€ PANEL â”€â”€ */
.panel{
background:var(â€“panel);border:1px solid var(â€“border);border-radius:6px;
padding:36px;position:relative;overflow:hidden;
}
.panel::before{content:â€™â€™;position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(â€“accent),transparent);animation:scanLine 3s ease-in-out infinite;}
@keyframes scanLine{0%,100%{opacity:.3}50%{opacity:1}}
.panel-corner{position:absolute;width:16px;height:16px;border-color:var(â€“accent);border-style:solid;opacity:.4;}
.panel-corner.tl{top:6px;left:6px;border-width:1px 0 0 1px;}
.panel-corner.tr{top:6px;right:6px;border-width:1px 1px 0 0;}
.panel-corner.bl{bottom:6px;left:6px;border-width:0 0 1px 1px;}
.panel-corner.br{bottom:6px;right:6px;border-width:0 1px 1px 0;}

/* â”€â”€ ENTRY â”€â”€ */
.entry-hero{text-align:center;margin-bottom:28px;position:relative;}
.entry-icon{font-size:3.2rem;display:block;margin-bottom:14px;animation:float 4s ease-in-out infinite;}
.entry-logo .title{font-family:â€˜Orbitronâ€™,monospace;font-size:2.3rem;font-weight:900;letter-spacing:5px;background:linear-gradient(135deg,var(â€“accent),var(â€“accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;display:block;margin-bottom:5px;}
.entry-logo .subtitle{font-size:.88rem;color:var(â€“muted);letter-spacing:6px;text-transform:uppercase;}
.stats-row{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-bottom:26px;}
.stat-chip{background:linear-gradient(135deg,rgba(0,212,255,.04),rgba(0,212,255,.08));border:1px solid rgba(0,212,255,.18);border-radius:6px;padding:10px;text-align:center;transition:border-color .2s,transform .2s;}
.stat-chip:hover{border-color:rgba(0,212,255,.4);transform:translateY(-1px);}
.stat-chip .val{font-family:â€˜Orbitronâ€™,monospace;font-size:1.2rem;color:var(â€“accent);display:block;}
.stat-chip .lbl{font-size:.58rem;color:var(â€“muted);text-transform:uppercase;letter-spacing:2px;}
.input-group{margin-bottom:16px;}
.input-group label{display:block;font-size:.72rem;letter-spacing:3px;color:var(â€“muted);text-transform:uppercase;margin-bottom:7px;}
.input-group input{width:100%;background:rgba(0,212,255,.04);border:1px solid var(â€“border);border-radius:4px;padding:13px 16px;color:var(â€“text);font-family:â€˜Rajdhaniâ€™,sans-serif;font-size:1.1rem;font-weight:600;outline:none;transition:border-color .3s,box-shadow .3s,background .3s;}
.input-group input:focus{border-color:var(â€“accent);box-shadow:var(â€“glow);background:rgba(0,212,255,.07);}

/* Attempts history */
.attempts-title{font-family:â€˜Orbitronâ€™,monospace;font-size:.68rem;letter-spacing:4px;color:var(â€“muted);text-transform:uppercase;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.attempts-title::after{content:â€™â€™;flex:1;height:1px;background:var(â€“border);}
.attempt-card{background:rgba(255,255,255,.02);border:1px solid var(â€“border);border-radius:4px;padding:12px 14px;display:flex;align-items:center;gap:12px;margin-bottom:7px;cursor:pointer;transition:all .2s;}
.attempt-card:hover{border-color:var(â€“accent);background:rgba(0,212,255,.05);}
.attempt-card .ac-name{flex:1;font-weight:700;font-size:.95rem;}
.attempt-card .ac-meta{font-size:.7rem;color:var(â€“muted);}
.attempt-card .ac-score{font-family:â€˜Orbitronâ€™,monospace;font-size:.95rem;color:var(â€“accent);}
.attempt-card .ac-grade{display:inline-block;padding:2px 8px;border-radius:12px;font-family:â€˜Orbitronâ€™,monospace;font-size:.62rem;font-weight:700;}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{display:block;width:100%;padding:13px;font-family:â€˜Orbitronâ€™,monospace;font-size:.82rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;border:none;border-radius:4px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden;}
.btn::after{content:â€™â€™;position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.08),transparent);opacity:0;transition:opacity .2s;}
.btn:hover::after{opacity:1;}
.btn-primary{background:linear-gradient(135deg,var(â€“accent),#0088cc);color:#000;box-shadow:0 4px 20px rgba(0,212,255,.28);}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,212,255,.46);}
.btn-secondary{background:transparent;border:1px solid var(â€“accent);color:var(â€“accent);}
.btn-secondary:hover{background:rgba(0,212,255,.09);}
.btn-danger{background:transparent;border:1px solid rgba(255,45,85,.5);color:var(â€“wrong);}
.btn-danger:hover{background:rgba(255,45,85,.1);}
.btn-gold{background:linear-gradient(135deg,#f0c040,#c87820);color:#000;box-shadow:0 4px 20px rgba(240,192,64,.25);}
.btn-gold:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(240,192,64,.4);}
.btn-sm{padding:9px;font-size:.72rem;letter-spacing:2px;}

/* â”€â”€ SECTION INTRO â”€â”€ */
.section-intro{text-align:center;padding:8px 0;}
.section-number{font-family:â€˜Orbitronâ€™,monospace;font-size:.68rem;letter-spacing:4px;color:var(â€“muted);margin-bottom:10px;}
.section-name-big{font-family:â€˜Orbitronâ€™,monospace;font-size:2.6rem;font-weight:900;letter-spacing:3px;margin-bottom:8px;}
.section-desc{font-size:1rem;color:var(â€“muted);margin-bottom:24px;line-height:1.6;max-width:480px;margin-left:auto;margin-right:auto;}
.section-info-row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:24px;}
.sinfo{background:rgba(255,255,255,.03);border:1px solid var(â€“border);border-radius:4px;padding:14px;text-align:center;}
.sinfo .v{font-family:â€˜Orbitronâ€™,monospace;font-size:1.4rem;color:var(â€“accent);display:block;}
.sinfo .l{font-size:.62rem;color:var(â€“muted);text-transform:uppercase;letter-spacing:2px;}
.section-progress-dots{display:flex;justify-content:center;gap:8px;margin-bottom:22px;}
.dot{width:40px;height:6px;border-radius:3px;background:var(â€“border2);transition:background .4s,box-shadow .4s;}
.dot.done{background:var(â€“accent2);}
.dot.active{background:var(â€“accent);box-shadow:0 0 12px var(â€“accent);}

/* â”€â”€ QUIZ â”€â”€ */
.quiz-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:12px;}
.q-meta{display:flex;flex-direction:column;gap:4px;}
.q-counter{font-family:â€˜Orbitronâ€™,monospace;font-size:.76rem;color:var(â€“muted);letter-spacing:2px;}
.category-tag{font-size:.6rem;letter-spacing:3px;text-transform:uppercase;padding:3px 9px;border-radius:2px;display:inline-block;}
.score-block{text-align:right;}
.score-label{font-size:.58rem;color:var(â€“muted);letter-spacing:2px;margin-bottom:1px;}
.score-display{font-family:â€˜Orbitronâ€™,monospace;font-size:1.12rem;font-weight:700;color:var(â€“accent);}
.score-display.negative{color:var(â€“wrong);}
.section-score-mini{font-size:.62rem;color:var(â€“muted);letter-spacing:1px;margin-top:2px;}
.progress-section-wrap{margin-bottom:16px;}
.pbar-label{font-size:.58rem;color:var(â€“muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:3px;display:flex;justify-content:space-between;}
.progress-bar{width:100%;height:4px;background:var(â€“border);border-radius:2px;overflow:hidden;margin-bottom:6px;}
.progress-fill{height:100%;border-radius:2px;transition:width .5s ease;}
.pf-overall{background:linear-gradient(90deg,var(â€“accent2),#cc4400);box-shadow:0 0 6px rgba(255,107,53,.4);}
.timer-wrap{display:flex;align-items:center;gap:12px;margin-bottom:18px;}
.timer-ring{position:relative;width:58px;height:58px;flex-shrink:0;}
.timer-ring svg{transform:rotate(-90deg);}
.timer-ring .track{fill:none;stroke:var(â€“border);stroke-width:4;}
.timer-ring .fill{fill:none;stroke:var(â€“accent);stroke-width:4;stroke-linecap:round;stroke-dasharray:163;stroke-dashoffset:0;transition:stroke-dashoffset 1s linear,stroke .3s;}
.timer-ring .fill.warning{stroke:var(â€“accent2);}
.timer-ring .fill.danger{stroke:var(â€“wrong);}
.timer-number{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:â€˜Orbitronâ€™,monospace;font-size:1rem;font-weight:700;}
.timer-bar-wrap{flex:1;}
.timer-label{font-size:.62rem;letter-spacing:2px;color:var(â€“muted);text-transform:uppercase;margin-bottom:4px;}
.timer-bar{height:5px;background:var(â€“border);border-radius:3px;overflow:hidden;}
.timer-bar-fill{height:100%;border-radius:3px;transition:width 1s linear,background .3s;}
.question-text{font-size:1.18rem;font-weight:600;line-height:1.6;margin-bottom:20px;color:var(â€“text);}
.options{display:flex;flex-direction:column;gap:9px;}
.option{padding:13px 16px;background:rgba(255,255,255,.025);border:1px solid var(â€“border);border-radius:4px;cursor:pointer;font-family:â€˜Rajdhaniâ€™,sans-serif;font-size:1rem;font-weight:600;color:var(â€“text);text-align:left;transition:all .2s;display:flex;align-items:center;gap:11px;}
.option:hover:not(.disabled){background:rgba(0,212,255,.07);border-color:var(â€“accent);transform:translateX(4px);}
.option.disabled{cursor:default;}
.option.correct{background:rgba(0,255,136,.12);border-color:var(â€“correct);color:var(â€“correct);box-shadow:0 0 14px rgba(0,255,136,.18);animation:pulseC .5s ease;}
.option.wrong{background:rgba(255,45,85,.12);border-color:var(â€“wrong);color:var(â€“wrong);animation:shake .4s ease;}
@keyframes pulseC{0%{transform:scale(1)}50%{transform:scale(1.015)}100%{transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}
.opt-letter{width:27px;height:27px;border:1px solid var(â€“muted);border-radius:3px;display:flex;align-items:center;justify-content:center;font-family:â€˜Orbitronâ€™,monospace;font-size:.66rem;font-weight:700;flex-shrink:0;transition:all .2s;}
.option.correct .opt-letter{border-color:var(â€“correct);background:rgba(0,255,136,.2);}
.option.wrong .opt-letter{border-color:var(â€“wrong);background:rgba(255,45,85,.2);}
.feedback-strip{margin-top:12px;padding:10px 15px;border-radius:4px;font-size:.9rem;font-weight:600;letter-spacing:1px;display:none;animation:slideUp .3s ease;}
@keyframes slideUp{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.feedback-strip.correct{display:block;background:rgba(0,255,136,.08);border:1px solid var(â€“correct);color:var(â€“correct);}
.feedback-strip.wrong{display:block;background:rgba(255,45,85,.08);border:1px solid var(â€“wrong);color:var(â€“wrong);}
.feedback-strip.timeout{display:block;background:rgba(255,107,53,.08);border:1px solid var(â€“accent2);color:var(â€“accent2);}

/* â”€â”€ SECTION END â”€â”€ */
.section-end-header{text-align:center;margin-bottom:20px;}
.sec-score-big{font-family:â€˜Orbitronâ€™,monospace;font-size:3.6rem;font-weight:900;line-height:1;display:block;animation:countUp .6s ease-out;}
@keyframes countUp{from{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}
.sec-score-label{font-size:.72rem;color:var(â€“muted);letter-spacing:3px;text-transform:uppercase;margin-top:4px;}
.mini-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:18px;}
.mstat{background:rgba(255,255,255,.025);border:1px solid var(â€“border);border-radius:4px;padding:12px;text-align:center;}
.mstat .n{font-family:â€˜Orbitronâ€™,monospace;font-size:1.5rem;font-weight:700;display:block;}
.mstat .l{font-size:.62rem;color:var(â€“muted);letter-spacing:2px;text-transform:uppercase;}
.n.green{color:var(â€“correct)}.n.red{color:var(â€“wrong)}.n.orange{color:var(â€“accent2)}
.q-review-list{display:flex;flex-direction:column;gap:6px;max-height:220px;overflow-y:auto;margin-bottom:16px;}
.q-review-list::-webkit-scrollbar{width:3px;}
.q-review-list::-webkit-scrollbar-thumb{background:var(â€“border);}
.q-review-item{padding:9px 12px;border-radius:4px;font-size:.85rem;border:1px solid var(â€“border);display:flex;align-items:flex-start;gap:10px;}
.q-review-item.r-correct{border-color:rgba(0,255,136,.3);background:rgba(0,255,136,.04);}
.q-review-item.r-wrong{border-color:rgba(255,45,85,.3);background:rgba(255,45,85,.04);}
.q-review-item.r-skip{border-color:rgba(255,107,53,.3);background:rgba(255,107,53,.04);}
.q-review-num{font-family:â€˜Orbitronâ€™,monospace;font-size:.65rem;color:var(â€“muted);min-width:22px;padding-top:1px;}
.q-review-body{flex:1;}
.q-review-q{font-weight:600;margin-bottom:3px;}
.q-review-ans{font-size:.78rem;color:var(â€“muted);}

/* â”€â”€ FINAL END â”€â”€ */
.final-score-display{text-align:center;margin-bottom:22px;}
.final-score-num{font-family:â€˜Orbitronâ€™,monospace;font-size:4.2rem;font-weight:900;line-height:1;display:block;background:linear-gradient(135deg,var(â€“accent),var(â€“accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:countUp .8s ease-out;margin-bottom:7px;}
.grade-badge{display:inline-block;padding:6px 20px;border-radius:30px;font-family:â€˜Orbitronâ€™,monospace;font-size:.9rem;font-weight:700;letter-spacing:3px;}
.grade-S{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#000;}
.grade-A{background:linear-gradient(135deg,#00ff88,#008844);color:#000;}
.grade-B{background:linear-gradient(135deg,#00d4ff,#0070aa);color:#000;}
.grade-C{background:linear-gradient(135deg,#a0a0ff,#5050cc);color:#fff;}
.grade-D{background:linear-gradient(135deg,#ff6b35,#cc3300);color:#fff;}
.grade-F{background:linear-gradient(135deg,#ff2d55,#880020);color:#fff;}
.performance-msg{font-size:1rem;color:var(â€“muted);margin-top:7px;}
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:9px;margin-bottom:16px;}
.stat-box{background:rgba(255,255,255,.025);border:1px solid var(â€“border);border-radius:4px;padding:12px;text-align:center;}
.stat-box .num{font-family:â€˜Orbitronâ€™,monospace;font-size:1.5rem;font-weight:700;display:block;}
.stat-box .lbl{font-size:.62rem;color:var(â€“muted);letter-spacing:2px;text-transform:uppercase;}
.breakdown-title{font-family:â€˜Orbitronâ€™,monospace;font-size:.68rem;letter-spacing:4px;color:var(â€“muted);text-transform:uppercase;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.breakdown-title::after{content:â€™â€™;flex:1;height:1px;background:var(â€“border);}
.breakdown-list{display:flex;flex-direction:column;gap:7px;margin-bottom:18px;}
.bk-row{display:flex;align-items:center;gap:10px;padding:9px 13px;background:rgba(255,255,255,.02);border:1px solid var(â€“border);border-radius:3px;}
.bk-name{flex:1;font-weight:600;font-size:.88rem;}
.bk-bar-wrap{width:110px;height:5px;background:var(â€“border);border-radius:3px;overflow:hidden;}
.bk-bar{height:100%;border-radius:3px;transition:width .8s ease;}
.bk-score{font-family:â€˜Orbitronâ€™,monospace;font-size:.78rem;min-width:38px;text-align:right;}
.btn-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:18px;}
.btn-row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:18px;}
.leaderboard-title{font-family:â€˜Orbitronâ€™,monospace;font-size:.68rem;letter-spacing:4px;color:var(â€“muted);text-transform:uppercase;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.leaderboard-title::after{content:â€™â€™;flex:1;height:1px;background:var(â€“border);}
.leaderboard-list{display:flex;flex-direction:column;gap:6px;max-height:180px;overflow-y:auto;}
.leaderboard-list::-webkit-scrollbar{width:3px;}
.leaderboard-list::-webkit-scrollbar-thumb{background:var(â€“border);}
.lb-entry{display:flex;align-items:center;gap:10px;padding:8px 12px;background:rgba(255,255,255,.02);border:1px solid var(â€“border);border-radius:3px;transition:all .15s;cursor:default;}
.lb-entry.clickable{cursor:pointer;}
.lb-entry.clickable:hover{border-color:var(â€“accent);background:rgba(0,212,255,.05);}
.lb-entry.current{border-color:var(â€“accent);background:rgba(0,212,255,.07);}
.lb-rank{font-family:â€˜Orbitronâ€™,monospace;font-size:.72rem;color:var(â€“muted);width:22px;text-align:center;}
.lb-rank.gold{color:#ffd700}.lb-rank.silver{color:#c0c0c0}.lb-rank.bronze{color:#cd7f32}
.lb-name{flex:1;font-weight:600;font-size:.9rem;}
.lb-score{font-family:â€˜Orbitronâ€™,monospace;font-size:.8rem;color:var(â€“accent);}
.lb-date{font-size:.62rem;color:var(â€“muted);margin-left:4px;}

/* â”€â”€ MODAL â”€â”€ */
.modal-overlay{
position:fixed;inset:0;background:rgba(4,8,16,.85);backdrop-filter:blur(8px);
z-index:200;display:none;align-items:center;justify-content:center;padding:20px;
animation:fadeIn .2s ease;
}
.modal-overlay.open{display:flex;}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal{
background:var(â€“panel2);border:1px solid var(â€“border);border-radius:8px;
padding:32px;max-width:460px;width:100%;position:relative;
animation:fadeUp .25s ease;
}
.modal-title{font-family:â€˜Orbitronâ€™,monospace;font-size:1.1rem;font-weight:700;margin-bottom:10px;color:var(â€“text);}
.modal-body{color:var(â€“muted);font-size:1rem;line-height:1.6;margin-bottom:22px;}
.modal-btns{display:grid;grid-template-columns:1fr 1fr;gap:10px;}

/* â”€â”€ ANALYTICS MODAL â”€â”€ */
.analytics-panel{max-width:600px;}
.analytics-score-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;padding:14px 18px;background:rgba(0,212,255,.05);border:1px solid rgba(0,212,255,.15);border-radius:4px;}
.analytics-big-score{font-family:â€˜Orbitronâ€™,monospace;font-size:2.4rem;font-weight:900;color:var(â€“accent);}
.analytics-meta{font-size:.8rem;color:var(â€“muted);text-align:right;line-height:1.7;}
.chart-wrap{margin-bottom:18px;}
.chart-title{font-family:â€˜Orbitronâ€™,monospace;font-size:.62rem;letter-spacing:3px;color:var(â€“muted);text-transform:uppercase;margin-bottom:8px;}
.radar-chart-wrap{display:flex;justify-content:center;margin-bottom:16px;}
.section-bars{display:flex;flex-direction:column;gap:8px;}
.sbar-row{display:flex;align-items:center;gap:10px;}
.sbar-name{width:130px;font-size:.82rem;font-weight:600;flex-shrink:0;}
.sbar-outer{flex:1;height:8px;background:var(â€“border);border-radius:4px;overflow:hidden;}
.sbar-fill{height:100%;border-radius:4px;transition:width 1s ease;}
.sbar-val{font-family:â€˜Orbitronâ€™,monospace;font-size:.72rem;min-width:38px;text-align:right;}

/* â”€â”€ TOAST â”€â”€ */
.toast{
position:fixed;bottom:24px;right:24px;z-index:300;
background:var(â€“panel2);border:1px solid var(â€“border);border-radius:6px;
padding:12px 18px;font-size:.88rem;font-weight:600;
max-width:280px;display:flex;align-items:center;gap:10px;
transform:translateY(80px);opacity:0;transition:all .35s ease;
box-shadow:0 8px 32px rgba(0,0,0,.4);
}
.toast.show{transform:translateY(0);opacity:1;}
.toast.t-success{border-color:rgba(0,255,136,.4);color:var(â€“correct);}
.toast.t-warn{border-color:rgba(255,107,53,.4);color:var(â€“accent2);}
.toast.t-info{border-color:rgba(0,212,255,.4);color:var(â€“accent);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PREMIUM CERTIFICATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media print{
body{background:white!important;margin:0!important;padding:0!important;}
body *{visibility:hidden;}
#certificate-wrap,#certificate-wrap *{visibility:visible;}
#certificate-wrap{position:fixed!important;inset:0!important;display:flex!important;align-items:center;justify-content:center;background:white!important;}
.no-print{display:none!important;}
}
#certificate-wrap{display:none;}

.cert-page{
width:297mm;min-height:210mm;
background:#faf8f2;
position:relative;
font-family:â€˜Cinzelâ€™,serif;
overflow:hidden;
display:flex;flex-direction:column;
padding:0;
}

/* Ornate border system */
.cert-border-outer{position:absolute;inset:10px;border:2.5px solid #8B6914;pointer-events:none;border-radius:2px;}
.cert-border-inner{position:absolute;inset:17px;border:1px solid #c8a840;pointer-events:none;border-radius:1px;}
.cert-border-thin{position:absolute;inset:20px;border:0.5px solid rgba(200,168,64,.4);pointer-events:none;}

/* Corner ornaments */
.cert-corner{position:absolute;width:52px;height:52px;}
.cert-corner svg{width:100%;height:100%;}
.cert-corner.tl{top:6px;left:6px;}
.cert-corner.tr{top:6px;right:6px;transform:scaleX(-1);}
.cert-corner.bl{bottom:6px;left:6px;transform:scaleY(-1);}
.cert-corner.br{bottom:6px;right:6px;transform:scale(-1);}

/* Background watermark */
.cert-watermark{
position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
opacity:.04;pointer-events:none;
font-family:â€˜Cinzelâ€™,serif;font-size:120px;font-weight:900;color:#8B6914;
letter-spacing:-4px;
}

/* Header band */
.cert-header-band{
background:linear-gradient(135deg,#0a1628 0%,#1a3060 50%,#0a1628 100%);
padding:22px 48px 18px;
display:flex;align-items:center;justify-content:space-between;
position:relative;
margin:28px 28px 0;
border-radius:3px;
}
.cert-header-band::after{content:â€™â€™;position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,#c8a840,transparent);}
.cert-logo-left{display:flex;align-items:center;gap:12px;}
.cert-logo-icon{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#00d4ff,#0060aa);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;}
.cert-logo-text{font-family:â€˜Orbitronâ€™,sans-serif;color:white;}
.cert-logo-text .clt-main{font-size:1rem;font-weight:900;letter-spacing:3px;display:block;}
.cert-logo-text .clt-sub{font-size:.5rem;letter-spacing:4px;color:rgba(255,255,255,.55);display:block;margin-top:1px;}
.cert-header-center{text-align:center;}
.cert-issuing{font-family:â€˜Cinzelâ€™,serif;color:#c8a840;font-size:.55rem;letter-spacing:4px;text-transform:uppercase;}
.cert-header-right{text-align:right;font-family:â€˜Orbitronâ€™,sans-serif;color:rgba(255,255,255,.5);font-size:.48rem;letter-spacing:2px;line-height:1.8;}

/* Main body */
.cert-body{flex:1;padding:20px 52px 16px;display:flex;flex-direction:column;align-items:center;}
.cert-awarded-text{font-family:â€˜Cinzelâ€™,serif;font-size:.62rem;letter-spacing:5px;color:#8B6914;text-transform:uppercase;margin-bottom:4px;text-align:center;}
.cert-title-main{font-family:â€˜Cinzelâ€™,serif;font-size:2rem;font-weight:700;color:#1a1a2e;letter-spacing:4px;text-align:center;margin-bottom:2px;line-height:1.2;}
.cert-title-sub{font-family:â€˜Playfair Displayâ€™,serif;font-style:italic;font-size:.78rem;color:#8B6914;letter-spacing:2px;text-align:center;margin-bottom:16px;}

.cert-divider{width:300px;height:1px;background:linear-gradient(90deg,transparent,#c8a840,transparent);margin:0 auto 16px;}
.cert-divider-ornament{text-align:center;color:#c8a840;font-size:1rem;margin-bottom:14px;letter-spacing:6px;}

.cert-presents-to{font-family:â€˜Playfair Displayâ€™,serif;font-size:.7rem;color:#666;letter-spacing:3px;text-align:center;margin-bottom:8px;}
.cert-recipient-name{
font-family:â€˜Cinzelâ€™,serif;font-size:2.2rem;font-weight:900;
color:#1a1a2e;text-align:center;letter-spacing:3px;
padding:6px 40px 12px;
border-bottom:2px solid #c8a840;
display:inline-block;margin-bottom:14px;
background:linear-gradient(135deg,#1a1a2e,#2a3060);
-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
position:relative;
}

.cert-main-text{
font-family:â€˜Playfair Displayâ€™,serif;font-size:.8rem;color:#444;
line-height:1.9;text-align:center;max-width:520px;margin-bottom:18px;
}
.cert-main-text em{font-style:italic;color:#8B6914;}

/* Score panel */
.cert-score-panel{
display:flex;align-items:center;gap:28px;
padding:14px 36px;
background:linear-gradient(135deg,#0a1628,#142040);
border:1px solid #c8a840;
border-radius:4px;
margin-bottom:16px;
position:relative;
}
.cert-score-panel::before{content:â€™â€™;position:absolute;inset:2px;border:0.5px solid rgba(200,168,64,.2);border-radius:2px;pointer-events:none;}
.cert-score-item{text-align:center;}
.cert-score-item .csiv{font-family:â€˜Orbitronâ€™,sans-serif;font-size:1.6rem;font-weight:900;color:#c8a840;display:block;line-height:1;}
.cert-score-item .csil{font-family:â€˜Orbitronâ€™,sans-serif;font-size:.42rem;letter-spacing:3px;color:rgba(200,168,64,.6);text-transform:uppercase;margin-top:3px;}
.cert-score-divider{width:1px;height:40px;background:rgba(200,168,64,.3);}
.cert-grade-circle{
width:72px;height:72px;border-radius:50%;
background:linear-gradient(135deg,#c8a840,#8B6914);
display:flex;align-items:center;justify-content:center;
font-family:â€˜Cinzelâ€™,serif;font-size:1.6rem;font-weight:900;color:#0a1628;
position:relative;
box-shadow:0 0 20px rgba(200,168,64,.3);
}
.cert-grade-circle::before{content:â€™â€™;position:absolute;inset:-3px;border-radius:50%;border:1px solid rgba(200,168,64,.4);}

/* Section mini bars */
.cert-sections-row{display:flex;gap:10px;margin-bottom:16px;justify-content:center;}
.cert-sec-item{text-align:center;width:72px;}
.cert-sec-bar-outer{height:32px;background:rgba(0,0,0,.06);border-radius:2px;overflow:hidden;display:flex;align-items:flex-end;margin-bottom:3px;border:0.5px solid rgba(0,0,0,.1);}
.cert-sec-bar-fill{width:100%;border-radius:2px 2px 0 0;}
.cert-sec-label{font-family:â€˜Orbitronâ€™,sans-serif;font-size:.42rem;letter-spacing:2px;color:#666;text-transform:uppercase;line-height:1.2;}
.cert-sec-val{font-family:â€˜Orbitronâ€™,sans-serif;font-size:.55rem;font-weight:700;color:#333;}

/* Footer */
.cert-footer{
padding:10px 52px 18px;
display:flex;align-items:flex-end;justify-content:space-between;
}
.cert-sig-block{text-align:center;}
.cert-sig-line{width:140px;height:1px;background:#8B6914;margin:0 auto 5px;}
.cert-sig-name{font-family:â€˜Cinzelâ€™,serif;font-size:.6rem;color:#333;letter-spacing:2px;}
.cert-sig-title{font-size:.48rem;color:#999;letter-spacing:2px;font-family:â€˜Cinzelâ€™,serif;margin-top:1px;}
.cert-seal-block{display:flex;flex-direction:column;align-items:center;gap:4px;}
.cert-seal{
width:72px;height:72px;border-radius:50%;
border:2.5px solid #8B6914;
display:flex;flex-direction:column;align-items:center;justify-content:center;
font-family:â€˜Orbitronâ€™,sans-serif;font-size:.38rem;letter-spacing:1.5px;color:#8B6914;text-align:center;
position:relative;background:radial-gradient(circle,rgba(200,168,64,.06),transparent);
line-height:1.6;
}
.cert-seal::before{content:â€™â€™;position:absolute;inset:3px;border-radius:50%;border:0.5px solid rgba(200,168,64,.3);}
.cert-seal-icon{font-size:1.2rem;display:block;margin-bottom:1px;}
.cert-id{font-size:.42rem;color:#bbb;font-family:â€˜Orbitronâ€™,sans-serif;letter-spacing:1px;margin-top:2px;}
.cert-date-block{text-align:right;}
.cert-date-label{font-size:.48rem;color:#999;letter-spacing:2px;font-family:â€˜Cinzelâ€™,serif;}
.cert-date-val{font-family:â€˜Cinzelâ€™,serif;font-size:.65rem;color:#333;letter-spacing:1px;margin-top:2px;}
</style>

</head>
<body>

<!-- BACKGROUND LAYERS -->

<div class="bg-grid"></div>
<div class="bg-glow"></div>
<div class="bg-stars" id="bg-stars"></div>

<!-- STATUS BAR -->

<div id="status-bar">
  <div class="status-left">
    <span class="status-brand">STEM+ Championship</span>
    <div class="online-badge online" id="online-badge">
      <div class="online-dot"></div>
      <span id="online-text">Online</span>
    </div>
  </div>
  <div class="status-right">
    <div class="status-icon" id="signal-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 6s4-4 11-4 11 4 11 4"/><path d="M5 10s2-2 7-2 7 2 7 2"/><path d="M9 14s1-1 3-1 3 1 3 1"/><circle cx="12" cy="18" r="1" fill="currentColor"/></svg>
      <span id="signal-text" style="font-size:.6rem;letter-spacing:1px;color:var(--muted);">Connected</span>
    </div>
    <div class="status-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8m-4-4v4"/></svg>
      <span style="font-size:.6rem;letter-spacing:1px;color:var(--muted);" id="clock-display">--:--</span>
    </div>
  </div>
</div>

<div id="app">

<!-- â”€â”€ ENTRY â”€â”€ -->

<div id="screen-entry" class="screen active">
<div class="panel">
  <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
  <div class="panel-corner bl"></div><div class="panel-corner br"></div>
  <div class="entry-hero entry-logo">
    <span class="entry-icon">ğŸ§ </span>
    <span class="title">STEM+ QUIZ</span>
    <span class="subtitle">Championship Series Â· 2025</span>
  </div>
  <div class="stats-row">
    <div class="stat-chip"><span class="val">5</span><span class="lbl">Sections</span></div>
    <div class="stat-chip"><span class="val">50</span><span class="lbl">Questions</span></div>
    <div class="stat-chip"><span class="val">8s</span><span class="lbl">Per Q</span></div>
    <div class="stat-chip"><span class="val">2pts</span><span class="lbl">Per Q</span></div>
    <div class="stat-chip"><span class="val">100</span><span class="lbl">Max Score</span></div>
  </div>
  <div class="input-group">
    <label>Candidate Name</label>
    <input type="text" id="name-input" placeholder="Enter your full name..." maxlength="40" autocomplete="off">
  </div>
  <button class="btn btn-primary" onclick="startQuiz()">Initialize Quiz â–¶</button>
  <div style="margin-top:26px;">
    <div class="leaderboard-title">Session Leaderboard <span style="font-size:.6rem;color:var(--muted);font-family:'Rajdhani',sans-serif;letter-spacing:1px;">(click to review)</span></div>
    <div class="leaderboard-list" id="entry-lb-list"><div style="color:var(--muted);font-size:.9rem;text-align:center;padding:14px;">No sessions yet</div></div>
  </div>
</div>
</div>

<!-- â”€â”€ SECTION INTRO â”€â”€ -->

<div id="screen-section-intro" class="screen">
<div class="nav-bar">
  <button class="nav-btn" onclick="goBackToEntry()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="15 18 9 12 15 6"/></svg>
    Back to Home
  </button>
</div>
<div class="panel">
  <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
  <div class="panel-corner bl"></div><div class="panel-corner br"></div>
  <div class="section-intro">
    <div class="section-number" id="intro-number">SECTION 1 OF 5</div>
    <div class="section-name-big" id="intro-name">SCIENCE</div>
    <div class="section-desc" id="intro-desc">Loading...</div>
    <div class="section-progress-dots" id="intro-dots"></div>
    <div class="section-info-row">
      <div class="sinfo"><span class="v">10</span><span class="l">Questions</span></div>
      <div class="sinfo"><span class="v">8s</span><span class="l">Per Question</span></div>
      <div class="sinfo"><span class="v">20</span><span class="l">Max Points</span></div>
    </div>
    <button class="btn btn-primary" id="intro-btn" onclick="startSection()">Begin Section â–¶</button>
  </div>
</div>
</div>

<!-- â”€â”€ QUIZ â”€â”€ -->

<div id="screen-quiz" class="screen">
<div class="nav-bar">
  <button class="nav-btn nav-quit" onclick="confirmQuit()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    Quit Quiz
  </button>
  <div class="nav-spacer"></div>
  <div style="font-family:'Orbitron',monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;padding:7px 0;" id="quiz-section-label">SECTION 1 / 5</div>
</div>
<div class="panel">
  <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
  <div class="panel-corner bl"></div><div class="panel-corner br"></div>
  <div class="quiz-header">
    <div class="q-meta">
      <div class="q-counter" id="q-counter">Q 1 / 10</div>
      <div id="category-tag" class="category-tag">SCIENCE</div>
    </div>
    <div class="score-block">
      <div class="score-label">TOTAL SCORE</div>
      <div class="score-display" id="score-display">0</div>
      <div class="section-score-mini" id="section-score-mini">Section: 0/20</div>
    </div>
  </div>
  <div class="progress-section-wrap">
    <div class="pbar-label"><span>Section Progress</span><span id="sec-prog-lbl">0%</span></div>
    <div class="progress-bar"><div class="progress-fill" id="progress-section" style="width:0%"></div></div>
    <div class="pbar-label"><span>Overall Progress</span><span id="ovr-prog-lbl">0%</span></div>
    <div class="progress-bar"><div class="progress-fill pf-overall" id="progress-overall" style="width:0%"></div></div>
  </div>
  <div class="timer-wrap">
    <div class="timer-ring">
      <svg viewBox="0 0 64 64" width="58" height="58">
        <circle class="track" cx="32" cy="32" r="26"/>
        <circle class="fill" id="timer-ring-fill" cx="32" cy="32" r="26"/>
      </svg>
      <div class="timer-number" id="timer-number">8</div>
    </div>
    <div class="timer-bar-wrap">
      <div class="timer-label">Time Remaining</div>
      <div class="timer-bar"><div class="timer-bar-fill" id="timer-bar-fill" style="width:100%"></div></div>
    </div>
  </div>
  <div class="question-text" id="question-text"></div>
  <div class="options" id="options-container"></div>
  <div class="feedback-strip" id="feedback-strip"></div>
</div>
</div>

<!-- â”€â”€ SECTION END â”€â”€ -->

<div id="screen-section-end" class="screen">
<div class="panel">
  <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
  <div class="panel-corner bl"></div><div class="panel-corner br"></div>
  <div class="section-end-header">
    <div style="font-size:.68rem;letter-spacing:3px;color:var(--muted);margin-bottom:8px;" id="se-section-label">SECTION COMPLETE</div>
    <span class="sec-score-big" id="se-score">0</span>
    <div class="sec-score-label" id="se-score-label">/ 20 points</div>
  </div>
  <div class="mini-stats">
    <div class="mstat"><span class="n green" id="se-correct">0</span><span class="l">Correct</span></div>
    <div class="mstat"><span class="n red" id="se-wrong">0</span><span class="l">Wrong</span></div>
    <div class="mstat"><span class="n orange" id="se-skip">0</span><span class="l">Skipped</span></div>
  </div>

  <div class="breakdown-title" style="margin-bottom:8px;">Question Review</div>
  <div class="q-review-list" id="se-review-list"></div>

  <div style="margin-bottom:16px;padding:12px;background:rgba(0,212,255,.05);border:1px solid rgba(0,212,255,.15);border-radius:4px;text-align:center;">
    <span style="font-size:.68rem;color:var(--muted);letter-spacing:2px;">CUMULATIVE SCORE</span>
    <div style="font-family:'Orbitron',monospace;font-size:1.65rem;color:var(--accent);margin-top:3px;" id="se-total">0</div>
  </div>
  <button class="btn btn-primary" id="se-next-btn" onclick="nextSection()">Next Section â–¶</button>
</div>
</div>

<!-- â”€â”€ FINAL END â”€â”€ -->

<div id="screen-end" class="screen">
<div class="panel no-print">
  <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
  <div class="panel-corner bl"></div><div class="panel-corner br"></div>
  <div class="final-score-display">
    <span class="final-score-num" id="final-score-num">0</span>
    <div id="grade-badge" class="grade-badge grade-A">GRADE A</div>
    <div class="performance-msg" id="performance-msg"></div>
  </div>
  <div class="stats-grid">
    <div class="stat-box"><span class="num green" id="correct-count">0</span><span class="lbl">Correct</span></div>
    <div class="stat-box"><span class="num red" id="wrong-count">0</span><span class="lbl">Wrong</span></div>
    <div class="stat-box"><span class="num orange" id="skip-count">0</span><span class="lbl">Skipped</span></div>
  </div>
  <div class="breakdown-title">Section Breakdown</div>
  <div class="breakdown-list" id="breakdown-list"></div>
  <div class="btn-row-3">
    <button class="btn btn-gold btn-sm" onclick="printCertificate()">ğŸ† Certificate</button>
    <button class="btn btn-secondary btn-sm" onclick="showAnalytics()">ğŸ“Š Analytics</button>
    <button class="btn btn-secondary btn-sm" onclick="restartQuiz()">â†º Play Again</button>
  </div>
  <div class="leaderboard-title">Session Leaderboard <span style="font-size:.6rem;color:var(--muted);font-family:'Rajdhani',sans-serif;letter-spacing:1px;">(click to review)</span></div>
  <div class="leaderboard-list" id="end-lb-list"></div>
</div>
</div>

</div><!-- #app -->

<!-- â•â• MODALS â•â• -->

<!-- Quit Confirm -->

<div class="modal-overlay" id="modal-quit">
  <div class="modal">
    <div class="panel-corner tl"></div><div class="panel-corner tr"></div>
    <div class="panel-corner bl"></div><div class="panel-corner br"></div>
    <div class="modal-title">âš  Quit Quiz?</div>
    <div class="modal-body">Your progress in the current section will be lost and the quiz will end early. Your score so far will be recorded to the leaderboard.</div>
    <div class="modal-btns">
      <button class="btn btn-secondary" onclick="closeModal('modal-quit')">Continue Quiz</button>
      <button class="btn btn-danger" onclick="doQuit()">Quit & Save Score</button>
    </div>
  </div>
</div>

<!-- Analytics Modal -->

<div class="modal-overlay" id="modal-analytics">
  <div class="modal analytics-panel" style="max-width:560px;max-height:90vh;overflow-y:auto;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
      <div class="modal-title" style="margin-bottom:0;" id="analytics-title">ğŸ“Š Analytics</div>
      <button class="nav-btn" style="width:auto;" onclick="closeModal('modal-analytics')">âœ• Close</button>
    </div>
    <div class="analytics-score-row">
      <div>
        <div class="analytics-big-score" id="an-score">0</div>
        <div style="font-size:.65rem;color:var(--muted);letter-spacing:2px;margin-top:3px;">FINAL SCORE</div>
      </div>
      <div id="an-grade-badge" class="grade-badge grade-A" style="align-self:center;">GRADE A</div>
      <div class="analytics-meta" id="an-meta">â€”</div>
    </div>
    <div class="chart-title">Performance by Section</div>
    <div class="section-bars" id="an-section-bars"></div>
    <div style="margin:14px 0;" class="chart-title">Accuracy Breakdown</div>
    <canvas id="an-canvas" width="480" height="120" style="width:100%;border-radius:4px;"></canvas>
    <div style="margin-top:14px;display:flex;gap:10px;">
      <button class="btn btn-gold btn-sm" style="flex:1;" onclick="closeModal('modal-analytics');printCertificate();">ğŸ† Download Certificate</button>
      <button class="btn btn-secondary btn-sm" style="flex:1;" onclick="closeModal('modal-analytics')">Close</button>
    </div>
  </div>
</div>

<!-- Review Attempt Modal -->

<div class="modal-overlay" id="modal-review">
  <div class="modal analytics-panel" style="max-width:560px;max-height:90vh;overflow-y:auto;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
      <div class="modal-title" style="margin-bottom:0;" id="review-title">ğŸ“‹ Attempt Review</div>
      <button class="nav-btn" style="width:auto;" onclick="closeModal('modal-review')">âœ• Close</button>
    </div>
    <div id="review-content"></div>
    <div style="margin-top:14px;display:flex;gap:10px;">
      <button class="btn btn-gold btn-sm" style="flex:1;" id="review-cert-btn">ğŸ† Re-print Certificate</button>
      <button class="btn btn-secondary btn-sm" style="flex:1;" onclick="closeModal('modal-review')">Close</button>
    </div>
  </div>
</div>

<!-- Toast -->

<div class="toast" id="toast">
  <span id="toast-icon">âœ“</span>
  <span id="toast-msg">Saved!</span>
</div>

<!-- â•â• CERTIFICATE â•â• -->

<div id="certificate-wrap">
<div class="cert-page" id="cert-page">
  <!-- Borders -->
  <div class="cert-border-outer"></div>
  <div class="cert-border-inner"></div>
  <div class="cert-border-thin"></div>
  <!-- Corner ornaments -->
  <div class="cert-corner tl">
    <svg viewBox="0 0 52 52" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2 2 L20 2 L2 20 Z" fill="rgba(139,105,20,.15)" stroke="#8B6914" stroke-width="0.8"/>
      <path d="M2 2 L14 2" stroke="#8B6914" stroke-width="1.5"/>
      <path d="M2 2 L2 14" stroke="#8B6914" stroke-width="1.5"/>
      <circle cx="8" cy="8" r="2" fill="#c8a840" opacity=".6"/>
      <path d="M16 6 L26 2 L22 12" stroke="#c8a840" stroke-width=".6" fill="none" opacity=".5"/>
    </svg>
  </div>
  <div class="cert-corner tr">
    <svg viewBox="0 0 52 52" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2 2 L20 2 L2 20 Z" fill="rgba(139,105,20,.15)" stroke="#8B6914" stroke-width="0.8"/>
      <path d="M2 2 L14 2" stroke="#8B6914" stroke-width="1.5"/>
      <path d="M2 2 L2 14" stroke="#8B6914" stroke-width="1.5"/>
      <circle cx="8" cy="8" r="2" fill="#c8a840" opacity=".6"/>
      <path d="M16 6 L26 2 L22 12" stroke="#c8a840" stroke-width=".6" fill="none" opacity=".5"/>
    </svg>
  </div>
  <div class="cert-corner bl">
    <svg viewBox="0 0 52 52" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2 2 L20 2 L2 20 Z" fill="rgba(139,105,20,.15)" stroke="#8B6914" stroke-width="0.8"/>
      <path d="M2 2 L14 2" stroke="#8B6914" stroke-width="1.5"/>
      <path d="M2 2 L2 14" stroke="#8B6914" stroke-width="1.5"/>
      <circle cx="8" cy="8" r="2" fill="#c8a840" opacity=".6"/>
      <path d="M16 6 L26 2 L22 12" stroke="#c8a840" stroke-width=".6" fill="none" opacity=".5"/>
    </svg>
  </div>
  <div class="cert-corner br">
    <svg viewBox="0 0 52 52" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2 2 L20 2 L2 20 Z" fill="rgba(139,105,20,.15)" stroke="#8B6914" stroke-width="0.8"/>
      <path d="M2 2 L14 2" stroke="#8B6914" stroke-width="1.5"/>
      <path d="M2 2 L2 14" stroke="#8B6914" stroke-width="1.5"/>
      <circle cx="8" cy="8" r="2" fill="#c8a840" opacity=".6"/>
      <path d="M16 6 L26 2 L22 12" stroke="#c8a840" stroke-width=".6" fill="none" opacity=".5"/>
    </svg>
  </div>
  <!-- Watermark -->
  <div class="cert-watermark">STEM+</div>

  <!-- Header band -->

  <div class="cert-header-band">
    <div class="cert-logo-left">
      <div class="cert-logo-icon">ğŸ§ </div>
      <div class="cert-logo-text">
        <span class="clt-main">STEM+ QUIZ</span>
        <span class="clt-sub">Championship Series</span>
      </div>
    </div>
    <div class="cert-header-center">
      <div class="cert-issuing">Official Certificate of Achievement</div>
    </div>
    <div class="cert-header-right">
      <div>YEAR Â· 2025</div>
      <div id="cert-id-display">ID: â€”â€”â€”â€”â€”â€”</div>
      <div>VERIFIED RECORD</div>
    </div>
  </div>

  <!-- Body -->

  <div class="cert-body">
    <div class="cert-awarded-text">This certificate is proudly awarded to</div>
    <div class="cert-divider-ornament">â§ âœ¦ â§</div>
    <div class="cert-recipient-name" id="cert-name">Candidate Name</div>

```
<div class="cert-main-text">
  For successfully completing the <em>STEM+ Quiz Championship</em>, having demonstrated<br>
  exceptional command of <em>Science, Technology, Engineering, Mathematics</em><br>
  and <em>General Knowledge</em> across five rigorous assessment sections.
</div>

<div class="cert-divider"></div>

<!-- Score panel -->
<div class="cert-score-panel">
  <div class="cert-score-item"><span class="csiv" id="cert-score">0</span><span class="csil">Final Score</span></div>
  <div class="cert-score-divider"></div>
  <div class="cert-grade-circle" id="cert-grade-circle">A</div>
  <div class="cert-score-divider"></div>
  <div class="cert-score-item"><span class="csiv" id="cert-accuracy">0%</span><span class="csil">Accuracy</span></div>
  <div class="cert-score-divider"></div>
  <div class="cert-score-item"><span class="csiv" id="cert-correct">0/50</span><span class="csil">Correct</span></div>
  <div class="cert-score-divider"></div>
  <div class="cert-score-item"><span class="csiv" id="cert-percentile">Top 20%</span><span class="csil">Percentile</span></div>
</div>

<!-- Section bars -->
<div class="cert-sections-row" id="cert-sections-row"></div>
```

  </div>

  <!-- Footer -->

  <div class="cert-footer">
    <div class="cert-sig-block">
      <div class="cert-sig-line"></div>
      <div class="cert-sig-name">Assessment Authority</div>
      <div class="cert-sig-title">STEM+ Championship Board</div>
    </div>
    <div class="cert-seal-block">
      <div class="cert-seal">
        <span class="cert-seal-icon">â­</span>
        <span>STEM+</span>
        <span>QUIZ</span>
        <span>CERTIFIED</span>
      </div>
      <div class="cert-id" id="cert-id">â€”</div>
    </div>
    <div class="cert-date-block">
      <div class="cert-sig-line" style="margin-left:auto;margin-right:0;"></div>
      <div class="cert-date-label">Date of Issue</div>
      <div class="cert-date-val" id="cert-date">â€”</div>
    </div>
  </div>

</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUESTION BANKS â€” 50 questions per section
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const BANK={
Science:[
  {q:"Which subatomic particle has no electric charge?",opts:["Proton","Neutron","Electron"],ans:1},
  {q:"What is the powerhouse of the cell?",opts:["Nucleus","Ribosome","Mitochondria"],ans:2},
  {q:"At what temperature (Â°C) does water boil at sea level?",opts:["90Â°C","100Â°C","110Â°C"],ans:1},
  {q:"Which planet has the most moons in our solar system?",opts:["Jupiter","Saturn","Uranus"],ans:1},
  {q:"What is the approximate speed of light in a vacuum?",opts:["3Ã—10â¸ m/s","3Ã—10â¶ m/s","3Ã—10Â¹â° m/s"],ans:0},
  {q:"DNA stands for?",opts:["Deoxyribonucleic Acid","Dinucleic Acid","Deoxyribose Amino Acid"],ans:0},
  {q:"Which gas makes up approximately 78% of Earth's atmosphere?",opts:["Oxygen","Carbon Dioxide","Nitrogen"],ans:2},
  {q:"The pH of a neutral solution is?",opts:["0","7","14"],ans:1},
  {q:"Which force keeps planets in orbit around the Sun?",opts:["Electromagnetic","Gravity","Nuclear Strong"],ans:1},
  {q:"What is the chemical symbol for Gold?",opts:["Go","Gd","Au"],ans:2},
  {q:"How many bones are in the adult human body?",opts:["196","206","216"],ans:1},
  {q:"What is the smallest unit of life?",opts:["Atom","Cell","Molecule"],ans:1},
  {q:"Which gas do plants absorb during photosynthesis?",opts:["Oxygen","Carbon Dioxide","Nitrogen"],ans:1},
  {q:"What is the chemical formula for water?",opts:["HO","Hâ‚‚O","Hâ‚ƒO"],ans:1},
  {q:"Which organ in the human body produces insulin?",opts:["Liver","Kidney","Pancreas"],ans:2},
  {q:"What type of rock is formed from cooled lava?",opts:["Sedimentary","Metamorphic","Igneous"],ans:2},
  {q:"The theory of evolution was proposed by?",opts:["Newton","Darwin","Einstein"],ans:1},
  {q:"What is the hardest natural substance on Earth?",opts:["Iron","Diamond","Quartz"],ans:1},
  {q:"Which planet is closest to the Sun?",opts:["Venus","Earth","Mercury"],ans:2},
  {q:"How many chambers does the human heart have?",opts:["2","3","4"],ans:2},
  {q:"What is the atomic number of Carbon?",opts:["6","8","12"],ans:0},
  {q:"Which vitamin is produced when skin is exposed to sunlight?",opts:["Vitamin A","Vitamin C","Vitamin D"],ans:2},
  {q:"What is the process by which water vapor turns into liquid?",opts:["Evaporation","Condensation","Sublimation"],ans:1},
  {q:"Which blood type is the universal donor?",opts:["AB+","O-","A+"],ans:1},
  {q:"What is the center of an atom called?",opts:["Electron","Neutron","Nucleus"],ans:2},
  {q:"Which element has the symbol Fe?",opts:["Fluorine","Iron","Francium"],ans:1},
  {q:"What is the largest organ in the human body?",opts:["Liver","Lung","Skin"],ans:2},
  {q:"Sound travels fastest through which medium?",opts:["Air","Water","Steel"],ans:2},
  {q:"What is the boiling point of liquid nitrogen at standard pressure?",opts:["-196Â°C","-100Â°C","-273Â°C"],ans:0},
  {q:"How many pairs of chromosomes do humans have?",opts:["22","23","46"],ans:1},
  {q:"Which planet has the Great Red Spot?",opts:["Saturn","Jupiter","Neptune"],ans:1},
  {q:"Which organ filters blood in the human body?",opts:["Liver","Spleen","Kidney"],ans:2},
  {q:"What is the chemical symbol for Sodium?",opts:["So","Sd","Na"],ans:2},
  {q:"Which type of radiation has the longest wavelength?",opts:["Gamma","Ultraviolet","Radio"],ans:2},
  {q:"The Earth rotates on its axis once every?",opts:["12 hours","24 hours","36 hours"],ans:1},
  {q:"What is the unit of measurement for electric resistance?",opts:["Volt","Watt","Ohm"],ans:2},
  {q:"Which gas is most abundant in the Sun?",opts:["Helium","Oxygen","Hydrogen"],ans:2},
  {q:"What is the name of the process plants use to make food?",opts:["Respiration","Photosynthesis","Digestion"],ans:1},
  {q:"Which planet is the largest in our solar system?",opts:["Saturn","Jupiter","Uranus"],ans:1},
  {q:"What is the chemical symbol for Silver?",opts:["Si","Ag","Sr"],ans:1},
  {q:"Which part of the brain controls balance?",opts:["Cerebrum","Cerebellum","Medulla"],ans:1},
  {q:"What is the speed of sound in air at 20Â°C?",opts:["343 m/s","1500 m/s","3000 m/s"],ans:0},
  {q:"Which element is liquid at room temperature besides mercury?",opts:["Bromine","Chlorine","Fluorine"],ans:0},
  {q:"What type of bond is formed when atoms share electrons?",opts:["Ionic","Covalent","Metallic"],ans:1},
  {q:"Which layer of Earth is liquid?",opts:["Crust","Mantle","Outer Core"],ans:2},
  {q:"How many moons does Mars have?",opts:["0","2","4"],ans:1},
  {q:"Which vitamin is essential for blood clotting?",opts:["Vitamin C","Vitamin K","Vitamin E"],ans:1},
  {q:"What force causes tides on Earth?",opts:["Wind","Moon's gravity","Earth's rotation"],ans:1},
  {q:"What is the chemical formula for carbon dioxide?",opts:["CO","COâ‚‚","Câ‚‚O"],ans:1},
  {q:"Which organelle contains the genetic material in a cell?",opts:["Ribosome","Mitochondria","Nucleus"],ans:2},
],
Technology:[
  {q:"What does HTTP stand for?",opts:["Hyper Text Transfer Protocol","High Transfer Text Protocol","Hyper Technical Transfer Program"],ans:0},
  {q:"Who co-founded Apple Inc. with Steve Wozniak?",opts:["Bill Gates","Steve Jobs","Elon Musk"],ans:1},
  {q:"What is the binary representation of decimal 10?",opts:["1010","1100","1001"],ans:0},
  {q:"Which company developed the Android operating system?",opts:["Apple","Google","Microsoft"],ans:1},
  {q:"What does CPU stand for?",opts:["Core Processing Utility","Central Processing Unit","Compute Power Unit"],ans:1},
  {q:"How many bits make one byte?",opts:["4","8","16"],ans:1},
  {q:"Which programming language uses indentation as syntax?",opts:["JavaScript","C++","Python"],ans:2},
  {q:"What does RAM stand for?",opts:["Random Access Memory","Read Arithmetic Memory","Rapid Access Module"],ans:0},
  {q:"Which protocol is used to send emails?",opts:["FTP","SMTP","HTTP"],ans:1},
  {q:"Who invented the World Wide Web?",opts:["Alan Turing","Tim Berners-Lee","Vint Cerf"],ans:1},
  {q:"What does URL stand for?",opts:["Universal Resource Locator","Uniform Resource Locator","United Resource Link"],ans:1},
  {q:"Which company created the Java programming language?",opts:["Microsoft","Sun Microsystems","IBM"],ans:1},
  {q:"What does AI stand for in computing?",opts:["Automated Input","Artificial Intelligence","Advanced Integration"],ans:1},
  {q:"What is the full form of USB?",opts:["Universal System Bus","Universal Serial Bus","United Service Board"],ans:1},
  {q:"Which company makes the iPhone?",opts:["Samsung","Google","Apple"],ans:2},
  {q:"What does HTML stand for?",opts:["Hyper Text Markup Language","High Tech Modern Language","Hyper Transfer Module Link"],ans:0},
  {q:"Which of these is NOT a programming language?",opts:["Python","Cobra","Photoshop"],ans:2},
  {q:"What is the default port for HTTPS?",opts:["80","443","8080"],ans:1},
  {q:"What does GPS stand for?",opts:["Global Positioning System","Geographic Placement System","General Position Satellite"],ans:0},
  {q:"What is the function of DNS?",opts:["Transfers files","Translates domain names to IPs","Encrypts data"],ans:1},
  {q:"What does SSD stand for?",opts:["Super Speed Drive","Solid State Drive","Secondary Storage Disk"],ans:1},
  {q:"Which company owns YouTube?",opts:["Microsoft","Meta","Google"],ans:2},
  {q:"What does VPN stand for?",opts:["Virtual Private Network","Very Public Network","Virtual Public Node"],ans:0},
  {q:"What is the main function of a firewall?",opts:["Speed up internet","Monitor CPU usage","Block unauthorized access"],ans:2},
  {q:"Which programming paradigm does C++ primarily support?",opts:["Functional","Object-Oriented","Procedural only"],ans:1},
  {q:"What does IoT stand for?",opts:["Internet of Terminals","Internet of Things","Integrated Object Technology"],ans:1},
  {q:"Which of these is an open-source operating system?",opts:["Windows","macOS","Linux"],ans:2},
  {q:"What does GUI stand for?",opts:["General User Interface","Graphical User Interface","Global Utility Interface"],ans:1},
  {q:"Who founded Microsoft?",opts:["Steve Jobs and Wozniak","Bill Gates and Paul Allen","Larry Page and Sergey Brin"],ans:1},
  {q:"What does the S in HTTPS stand for?",opts:["Speed","Secure","Standard"],ans:1},
  {q:"Which technology is used for wireless short-range communication?",opts:["Infrared","Bluetooth","Satellite"],ans:1},
  {q:"What is phishing in cybersecurity?",opts:["A type of encryption","Fraudulent attempt to steal info","A network protocol"],ans:1},
  {q:"What does API stand for?",opts:["Application Programming Interface","Advanced Program Integration","Automated Protocol Interface"],ans:0},
  {q:"Which data structure operates on LIFO principle?",opts:["Queue","Stack","Array"],ans:1},
  {q:"What is the purpose of a compiler?",opts:["Execute programs","Translate source code to machine code","Store data"],ans:1},
  {q:"Which company developed ChatGPT?",opts:["Google","Meta","OpenAI"],ans:2},
  {q:"What is a bug in programming?",opts:["A feature request","An error in code","A type of virus"],ans:1},
  {q:"Which language is primarily used for web styling?",opts:["Python","CSS","SQL"],ans:1},
  {q:"What does OCR stand for?",opts:["Optical Character Recognition","Online Code Repository","Open Content Resource"],ans:0},
  {q:"What is bandwidth in networking?",opts:["Speed of processor","Data transfer capacity","Size of hard disk"],ans:1},
  {q:"Which protocol assigns IP addresses automatically?",opts:["FTP","DHCP","TCP"],ans:1},
  {q:"What is Moore's Law about?",opts:["Internet speeds","Transistor count doubling","Battery life"],ans:1},
  {q:"What is malware?",opts:["Useful software","Malicious software","Hardware component"],ans:1},
  {q:"What does SQL stand for?",opts:["Structured Query Language","Standard Question Logic","System Query List"],ans:0},
  {q:"What is latency in networking?",opts:["Data packet size","Delay in data transmission","Network bandwidth"],ans:1},
  {q:"Which type of AI can learn from data without explicit programming?",opts:["Symbolic AI","Machine Learning","Expert System"],ans:1},
  {q:"What does ROM stand for?",opts:["Random Output Memory","Read Only Memory","Rewritable Output Module"],ans:1},
  {q:"What is the purpose of an IP address?",opts:["Encrypt data","Identify devices on a network","Compress files"],ans:1},
  {q:"Which sorting algorithm has best average-case time complexity?",opts:["Bubble Sort","Merge Sort","Selection Sort"],ans:1},
  {q:"What does NFC stand for?",opts:["Network File Control","Near Field Communication","Node Frequency Circuit"],ans:1},
],
Engineering:[
  {q:"What material has the highest tensile strength among common materials?",opts:["Steel","Carbon Fiber","Aluminum"],ans:1},
  {q:"What is the SI unit of electric current?",opts:["Volt","Ohm","Ampere"],ans:2},
  {q:"Ohm's Law states: V = ?",opts:["I Ã— R","I / R","I + R"],ans:0},
  {q:"What does CAD stand for in engineering?",opts:["Computer Aided Design","Calibrated Angle Drawing","Component Assembly Data"],ans:0},
  {q:"The First Law of Thermodynamics concerns conservation of?",opts:["Momentum","Mass","Energy"],ans:2},
  {q:"Which metal has the highest electrical conductivity?",opts:["Copper","Gold","Silver"],ans:2},
  {q:"What is the purpose of a transformer?",opts:["Store energy","Change voltage levels","Amplify signals"],ans:1},
  {q:"What is the unit of power?",opts:["Joule","Newton","Watt"],ans:2},
  {q:"What does PLC stand for in industrial engineering?",opts:["Programmable Logic Controller","Pressure Load Calculator","Primary Loop Control"],ans:0},
  {q:"What is the yield strength of a material?",opts:["Stress at fracture","Stress at onset of permanent deformation","Elastic modulus"],ans:1},
  {q:"Which civil engineering structure resists mainly compressive forces?",opts:["Cable","Arch","Beam"],ans:1},
  {q:"What is Bernoulli's principle related to?",opts:["Electric fields","Fluid dynamics","Optics"],ans:1},
  {q:"Which type of gear provides the highest torque multiplication?",opts:["Spur gear","Planetary gear","Helical gear"],ans:1},
  {q:"What does factor of safety mean?",opts:["Efficiency ratio","Ratio of failure load to working load","Percentage energy loss"],ans:1},
  {q:"What is the purpose of a heat exchanger?",opts:["Generate electricity","Transfer heat between fluids","Filter impurities"],ans:1},
  {q:"What does FEA stand for?",opts:["Fluid Element Analysis","Finite Element Analysis","Force and Energy Analysis"],ans:1},
  {q:"Which law relates stress and strain in elastic materials?",opts:["Newton's Law","Hooke's Law","Boyle's Law"],ans:1},
  {q:"What is the function of a diode?",opts:["Amplify signals","Allow current in one direction","Store charge"],ans:1},
  {q:"What does PWM stand for in electronics?",opts:["Power Width Measurement","Pulse Width Modulation","Peripheral Wave Management"],ans:1},
  {q:"What is Reynolds number used to predict?",opts:["Electrical resistance","Fluid flow patterns","Structural loads"],ans:1},
  {q:"What does CNC stand for?",opts:["Computer Numerical Control","Central Node Circuit","Continuous Network Command"],ans:0},
  {q:"What is the purpose of a capacitor in a circuit?",opts:["Regulate current direction","Store and release electrical energy","Convert AC to DC"],ans:1},
  {q:"What type of stress does a bolt under tension experience?",opts:["Compressive","Tensile","Shear"],ans:1},
  {q:"What does RMS stand for in electrical engineering?",opts:["Rated Maximum Signal","Root Mean Square","Relative Magnetic Strength"],ans:1},
  {q:"Which type of foundation is used in weak soils?",opts:["Strip foundation","Pile foundation","Raft foundation"],ans:1},
  {q:"What does GIS stand for in civil engineering?",opts:["Geographic Information System","Ground Investigation Survey","General Inspection Standard"],ans:0},
  {q:"Which law describes the relationship between current and magnetic fields?",opts:["Faraday's Law","Ampere's Law","Coulomb's Law"],ans:1},
  {q:"What is the purpose of an op-amp?",opts:["Generate power","Amplify voltage differences","Store binary data"],ans:1},
  {q:"In structural analysis, what is a moment?",opts:["Linear force","Rotational effect of a force","Impact energy"],ans:1},
  {q:"What does IC stand for in electronics?",opts:["Inductive Coil","Integrated Circuit","Internal Component"],ans:1},
  {q:"Which metal alloy is most commonly used in aircraft structures?",opts:["Titanium","Aluminum alloy","Carbon steel"],ans:1},
  {q:"What is the main advantage of DC over AC motors?",opts:["Simpler construction","Easier speed control","Higher efficiency"],ans:1},
  {q:"Which process reduces metal ore by heating with carbon?",opts:["Oxidation","Smelting","Annealing"],ans:1},
  {q:"What does HVAC stand for?",opts:["High Voltage AC","Heating Ventilation and Air Conditioning","Hydraulic Valve and Control"],ans:1},
  {q:"What is the SI unit of pressure?",opts:["Newton","Pascal","Bar"],ans:1},
  {q:"Which engineering branch focuses on robots and automation?",opts:["Mechatronics","Geotechnical","Marine"],ans:0},
  {q:"What is the function of a transistor?",opts:["Amplify or switch electronic signals","Store magnetic fields","Generate light"],ans:0},
  {q:"What does latent heat refer to?",opts:["Stored elastic energy","Heat absorbed during phase change","Thermal conductivity"],ans:1},
  {q:"Which type of pump is most efficient for high-volume low-pressure?",opts:["Gear pump","Centrifugal pump","Piston pump"],ans:1},
  {q:"What is the primary purpose of rebar in concrete?",opts:["Reduce weight","Improve tensile strength","Increase thermal resistance"],ans:1},
  {q:"What does EMF stand for in electrical engineering?",opts:["Electromotive Force","Electromagnetic Flux","Energy Modulation Factor"],ans:0},
  {q:"Which type of stress causes material layers to slide?",opts:["Tensile","Compressive","Shear"],ans:2},
  {q:"What is the purpose of a check valve?",opts:["Regulate flow rate","Prevent backflow","Measure pressure"],ans:1},
  {q:"Which property describes a material's ability to absorb energy before fracturing?",opts:["Hardness","Toughness","Stiffness"],ans:1},
  {q:"What does the Second Law of Thermodynamics state?",opts:["Energy is conserved","Entropy tends to increase","Force equals mass times acceleration"],ans:1},
  {q:"What is the purpose of a Wheatstone bridge circuit?",opts:["Amplify voltage","Measure resistance accurately","Generate AC power"],ans:1},
  {q:"Which material property resists scratching and indentation?",opts:["Ductility","Hardness","Toughness"],ans:1},
  {q:"What does the term creep mean in materials engineering?",opts:["Sudden fracture","Slow permanent deformation under stress","Elastic recovery"],ans:1},
  {q:"What is the purpose of a surge protector?",opts:["Increase voltage","Protect from voltage spikes","Store electrical energy"],ans:1},
  {q:"What does AC stand for in electrical engineering?",opts:["Amplified Current","Alternating Current","Automated Circuit"],ans:1},
],
Mathematics:[
  {q:"What is the value of Ï€ to 2 decimal places?",opts:["3.12","3.14","3.16"],ans:1},
  {q:"What is the square root of 144?",opts:["11","12","13"],ans:1},
  {q:"If f(x) = xÂ², what is f'(x)?",opts:["x","2x","xÂ²"],ans:1},
  {q:"What is the sum of angles in a triangle?",opts:["90Â°","180Â°","360Â°"],ans:1},
  {q:"What is 7! (7 factorial)?",opts:["2520","5040","40320"],ans:1},
  {q:"Fibonacci sequence: 0,1,1,2,3,5 â€” what comes next?",opts:["7","8","9"],ans:1},
  {q:"What is logâ‚â‚€(1000)?",opts:["2","3","4"],ans:1},
  {q:"A right triangle has legs 3 and 4. What is the hypotenuse?",opts:["5","6","7"],ans:0},
  {q:"What is the probability of flipping heads twice in a row?",opts:["1/2","1/4","1/3"],ans:1},
  {q:"What is the largest prime number below 20?",opts:["17","19","16"],ans:1},
  {q:"What is 2Â¹â°?",opts:["512","1024","2048"],ans:1},
  {q:"What is the area of a circle with radius 5?",opts:["25Ï€","10Ï€","5Ï€"],ans:0},
  {q:"What is the derivative of sin(x)?",opts:["cos(x)","-cos(x)","tan(x)"],ans:0},
  {q:"What is the sum of the first 100 natural numbers?",opts:["4950","5000","5050"],ans:2},
  {q:"What is 15% of 200?",opts:["25","30","35"],ans:1},
  {q:"How many sides does a dodecagon have?",opts:["10","12","14"],ans:1},
  {q:"What is the integral of x dx?",opts:["xÂ²","xÂ²/2 + C","2x + C"],ans:1},
  {q:"What is the value of e (Euler's number) to 2 decimal places?",opts:["2.71","2.81","2.61"],ans:0},
  {q:"If 3x + 7 = 22, what is x?",opts:["3","5","7"],ans:1},
  {q:"What is the perimeter of a square with side length 6?",opts:["12","24","36"],ans:1},
  {q:"How many degrees are in a full circle?",opts:["180","270","360"],ans:2},
  {q:"What is the mode of: 2,3,3,4,5,5,5,6?",opts:["3","4","5"],ans:2},
  {q:"What is cos(60Â°)?",opts:["0.5","âˆš3/2","1"],ans:0},
  {q:"Simplify: (xÂ³)(xâ´)",opts:["xâ·","xÂ¹Â²","x"],ans:0},
  {q:"What is the slope of the line y = 3x + 7?",opts:["7","3","1/3"],ans:1},
  {q:"How many edges does a cube have?",opts:["8","10","12"],ans:2},
  {q:"What is 0! (zero factorial)?",opts:["0","1","Undefined"],ans:1},
  {q:"Which of these is an irrational number?",opts:["0.5","âˆš2","3/4"],ans:1},
  {q:"What is the median of: 3,7,5,9,1?",opts:["5","7","3"],ans:0},
  {q:"A triangle has angles 50Â° and 70Â°. The third angle is?",opts:["50Â°","60Â°","70Â°"],ans:1},
  {q:"What is 25Â²?",opts:["525","625","725"],ans:1},
  {q:"What is the volume of a cube with side length 3?",opts:["9","18","27"],ans:2},
  {q:"What is 12/5 as a decimal?",opts:["2.2","2.4","2.6"],ans:1},
  {q:"What is the LCM of 4 and 6?",opts:["8","12","24"],ans:1},
  {q:"If a set has 4 elements, how many subsets does it have?",opts:["8","16","32"],ans:1},
  {q:"What is tan(45Â°)?",opts:["0","0.5","1"],ans:2},
  {q:"What is the HCF of 18 and 24?",opts:["3","6","9"],ans:1},
  {q:"Which is larger: 2/3 or 3/4?",opts:["2/3","3/4","Equal"],ans:1},
  {q:"What is the surface area of a sphere with radius r?",opts:["2Ï€rÂ²","4Ï€rÂ²","Ï€rÂ²"],ans:1},
  {q:"How many prime numbers are between 1 and 20?",opts:["6","7","8"],ans:2},
  {q:"What is the nth term of the arithmetic sequence 3,7,11,15...?",opts:["2n+1","4n-1","3n+1"],ans:1},
  {q:"What is the probability of rolling a 6 on a fair die?",opts:["1/3","1/4","1/6"],ans:2},
  {q:"What is the conjugate of 3+4i?",opts:["3-4i","-3+4i","-3-4i"],ans:0},
  {q:"Solve: 2Â² + 3Â²",opts:["10","13","25"],ans:1},
  {q:"Which of these is a geometric sequence?",opts:["1,3,5,7","2,4,8,16","1,4,9,16"],ans:1},
  {q:"What is âˆ«â‚€Â¹ xÂ² dx?",opts:["1/2","1/3","1/4"],ans:1},
  {q:"How many vertices does a tetrahedron have?",opts:["3","4","5"],ans:1},
  {q:"What is the exact value of sin(90Â°)?",opts:["0","0.5","1"],ans:2},
  {q:"If P(A)=0.3 and P(B)=0.5 independent, P(Aâˆ©B)=?",opts:["0.8","0.15","0.2"],ans:1},
  {q:"What is the discriminant formula for axÂ²+bx+c?",opts:["bÂ²-4ac","bÂ²+4ac","2b-4ac"],ans:0},
],
"General Knowledge":[
  {q:"What is the capital of France?",opts:["Berlin","Paris","Rome"],ans:1},
  {q:"Which country has the largest population?",opts:["USA","China","India"],ans:1},
  {q:"What is the longest river in the world?",opts:["Amazon","Nile","Yangtze"],ans:1},
  {q:"Who wrote Romeo and Juliet?",opts:["Dickens","Shakespeare","Hemingway"],ans:1},
  {q:"What is the currency of Japan?",opts:["Yuan","Won","Yen"],ans:2},
  {q:"Which is the largest continent?",opts:["Africa","Asia","Europe"],ans:1},
  {q:"How many colors are in a rainbow?",opts:["5","6","7"],ans:2},
  {q:"What year did World War II end?",opts:["1943","1945","1947"],ans:1},
  {q:"Which ocean is the largest?",opts:["Atlantic","Indian","Pacific"],ans:2},
  {q:"What is the official language of Brazil?",opts:["Spanish","Portuguese","French"],ans:1},
  {q:"Who painted the Mona Lisa?",opts:["Michelangelo","Da Vinci","Raphael"],ans:1},
  {q:"What is the smallest country in the world?",opts:["Monaco","San Marino","Vatican City"],ans:2},
  {q:"How many continents are there on Earth?",opts:["5","6","7"],ans:2},
  {q:"Which is the tallest mountain in the world?",opts:["K2","Mount Everest","Kangchenjunga"],ans:1},
  {q:"Who invented the telephone?",opts:["Edison","Alexander Graham Bell","Tesla"],ans:1},
  {q:"Which country gifted the Statue of Liberty to the USA?",opts:["UK","Canada","France"],ans:2},
  {q:"How many players are in a standard soccer team?",opts:["9","10","11"],ans:2},
  {q:"What is the capital of Nigeria?",opts:["Lagos","Kano","Abuja"],ans:2},
  {q:"What year did the first iPhone launch?",opts:["2005","2007","2009"],ans:1},
  {q:"Who was the first human to walk on the Moon?",opts:["Buzz Aldrin","Yuri Gagarin","Neil Armstrong"],ans:2},
  {q:"Which country is known as the Land of the Rising Sun?",opts:["China","South Korea","Japan"],ans:2},
  {q:"Which country has the most Olympic gold medals of all time?",opts:["Russia","China","United States"],ans:2},
  {q:"In which year did the Berlin Wall fall?",opts:["1987","1989","1991"],ans:1},
  {q:"Which animal is the fastest on land?",opts:["Lion","Cheetah","Gazelle"],ans:1},
  {q:"What is the capital of Australia?",opts:["Sydney","Melbourne","Canberra"],ans:2},
  {q:"How many strings does a standard guitar have?",opts:["4","6","8"],ans:1},
  {q:"Which is the longest bone in the human body?",opts:["Spine","Femur","Humerus"],ans:1},
  {q:"What is the currency of the United Kingdom?",opts:["Euro","Dollar","Pound Sterling"],ans:2},
  {q:"Who discovered penicillin?",opts:["Marie Curie","Alexander Fleming","Louis Pasteur"],ans:1},
  {q:"What is the capital of China?",opts:["Shanghai","Hong Kong","Beijing"],ans:2},
  {q:"How many days are in a leap year?",opts:["365","366","367"],ans:1},
  {q:"Which language is most widely spoken by native speakers?",opts:["English","Mandarin Chinese","Spanish"],ans:1},
  {q:"What is the largest desert in the world?",opts:["Sahara","Gobi","Antarctic"],ans:2},
  {q:"Which vitamin deficiency causes scurvy?",opts:["Vitamin A","Vitamin B12","Vitamin C"],ans:2},
  {q:"What year did the Titanic sink?",opts:["1910","1912","1914"],ans:1},
  {q:"Which country invented pizza?",opts:["France","Italy","Greece"],ans:1},
  {q:"What is the boiling point of water in Fahrenheit?",opts:["200Â°F","212Â°F","220Â°F"],ans:1},
  {q:"Who wrote the novel 1984?",opts:["Aldous Huxley","George Orwell","Ray Bradbury"],ans:1},
  {q:"What does WHO stand for?",opts:["World Health Organization","World Humanitarian Office","Western Health Organization"],ans:0},
  {q:"Which metal is extracted from bauxite ore?",opts:["Iron","Copper","Aluminum"],ans:2},
  {q:"What is the capital of Japan?",opts:["Osaka","Kyoto","Tokyo"],ans:2},
  {q:"Which planet is known as the Blue Planet?",opts:["Neptune","Uranus","Earth"],ans:2},
  {q:"Who was the first President of the United States?",opts:["Abraham Lincoln","Thomas Jefferson","George Washington"],ans:2},
  {q:"What is the name of the world's largest rainforest?",opts:["Congo","Amazon","Borneo"],ans:1},
  {q:"How many sides does a hexagon have?",opts:["5","6","7"],ans:1},
  {q:"Which country has the Eiffel Tower?",opts:["Italy","Spain","France"],ans:2},
  {q:"What is the hardest natural substance?",opts:["Granite","Gold","Diamond"],ans:2},
  {q:"How many hours are in a week?",opts:["148","168","180"],ans:1},
  {q:"Which scientist developed the theory of general relativity?",opts:["Newton","Hawking","Einstein"],ans:2},
  {q:"What is the chemical symbol for water?",opts:["WO","Hâ‚‚O","HOâ‚‚"],ans:1},
]
};

const SECTIONS=[
  {key:"Science",        color:"#00d4ff", icon:"ğŸ”¬", desc:"Test your knowledge of fundamental scientific principles, biology, chemistry and physics."},
  {key:"Technology",     color:"#7fff00", icon:"ğŸ’»", desc:"From hardware to software, AI to networking â€” how well do you know the tech world?"},
  {key:"Engineering",    color:"#ff6b35", icon:"âš™ï¸", desc:"Structural, electrical, mechanical and chemical engineering concepts put to the test."},
  {key:"Mathematics",    color:"#ff2d55", icon:"ğŸ“", desc:"Numbers, equations, geometry and calculus â€” prove your mathematical mastery."},
  {key:"General Knowledge",color:"#ffd700",icon:"ğŸŒ",desc:"History, geography, culture, science and world affairs â€” how broad is your knowledge?"},
];
const QPS=10,PTS=2,TIME=8;

// â”€â”€ STATE â”€â”€
let candidateName='',currentSection=0,sectionQuestions=[],currentQ=0;
let score=0,sectionScore=0,correctCount=0,wrongCount=0,skipCount=0;
let sCorrect=0,sWrong=0,sSkip=0,sectionResults=[];
let allQResults=[]; // stores per-question results for review
let timerInterval=null,timeLeft=TIME,answered=false;
let currentAttemptId=null;
let leaderboard=[];
try{leaderboard=JSON.parse(localStorage.getItem('stemLB4')||'[]');}catch(e){}

// â”€â”€ AUDIO â”€â”€
let audioCtx=null;
function ga(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();return audioCtx;}
function playSound(t){
  try{
    const ctx=ga(),osc=ctx.createOscillator(),g=ctx.createGain();
    osc.connect(g);g.connect(ctx.destination);const now=ctx.currentTime;
    if(t==='correct'){osc.type='sine';[523,659,784].forEach((f,i)=>osc.frequency.setValueAtTime(f,now+i*.1));g.gain.setValueAtTime(.15,now);g.gain.exponentialRampToValueAtTime(.001,now+.5);osc.start(now);osc.stop(now+.5);}
    else if(t==='wrong'){osc.type='square';osc.frequency.setValueAtTime(200,now);osc.frequency.setValueAtTime(130,now+.15);g.gain.setValueAtTime(.11,now);g.gain.exponentialRampToValueAtTime(.001,now+.35);osc.start(now);osc.stop(now+.35);}
    else if(t==='tick'){osc.type='sine';osc.frequency.setValueAtTime(900,now);g.gain.setValueAtTime(.04,now);g.gain.exponentialRampToValueAtTime(.001,now+.07);osc.start(now);osc.stop(now+.07);}
    else if(t==='timeout'){osc.type='sawtooth';osc.frequency.setValueAtTime(280,now);osc.frequency.setValueAtTime(80,now+.3);g.gain.setValueAtTime(.09,now);g.gain.exponentialRampToValueAtValue(.001,now+.4);osc.start(now);osc.stop(now+.4);}
    else if(t==='section'){[523,659,784,1047].forEach((f,i)=>{const o2=ctx.createOscillator(),g2=ctx.createGain();o2.connect(g2);g2.connect(ctx.destination);o2.type='sine';o2.frequency.setValueAtTime(f,now+i*.1);g2.gain.setValueAtTime(.09,now+i*.1);g2.gain.exponentialRampToValueAtTime(.001,now+i*.1+.28);o2.start(now+i*.1);o2.stop(now+i*.1+.28);});}
  }catch(e){}
}

// â”€â”€ ONLINE STATUS â”€â”€
function updateOnlineStatus(){
  const badge=document.getElementById('online-badge');
  const txt=document.getElementById('online-text');
  const sig=document.getElementById('signal-text');
  if(navigator.onLine){
    badge.className='online-badge online';
    txt.textContent='Online';
    sig.textContent='Connected';
    sig.style.color='var(--correct)';
  } else {
    badge.className='online-badge offline';
    txt.textContent='Offline';
    sig.textContent='Disconnected';
    sig.style.color='var(--wrong)';
  }
}
window.addEventListener('online',updateOnlineStatus);
window.addEventListener('offline',updateOnlineStatus);
updateOnlineStatus();

// â”€â”€ CLOCK â”€â”€
function updateClock(){
  const now=new Date();
  document.getElementById('clock-display').textContent=now.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
}
setInterval(updateClock,1000);updateClock();

// â”€â”€ STARS â”€â”€
(function(){
  const stars=document.getElementById('bg-stars');
  for(let i=0;i<60;i++){
    const s=document.createElement('div');
    const sz=Math.random()*1.5+0.5;
    s.style.cssText=`position:absolute;width:${sz}px;height:${sz}px;border-radius:50%;background:rgba(255,255,255,${Math.random()*.4+.1});top:${Math.random()*100}%;left:${Math.random()*100}%;animation:twinkle ${3+Math.random()*4}s infinite ${Math.random()*4}s;`;
    stars.appendChild(s);
  }
})();

// â”€â”€ UTILS â”€â”€
function showScreen(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById('screen-'+id).classList.add('active');window.scrollTo(0,0);}
function closeModal(id){document.getElementById(id).classList.remove('open');}
function openModal(id){document.getElementById(id).classList.add('open');}

function showToast(msg,type='info'){
  const t=document.getElementById('toast');
  const icons={info:'â„¹',success:'âœ“',warn:'âš '};
  document.getElementById('toast-icon').textContent=icons[type]||'â„¹';
  document.getElementById('toast-msg').textContent=msg;
  t.className=`toast t-${type} show`;
  setTimeout(()=>t.classList.remove('show'),3000);
}

function getGrade(s){
  const max=SECTIONS.length*QPS*PTS;const p=(s/max)*100;
  if(p>=90)return{grade:'S',msg:'ğŸŒŸ Outstanding! Perfect-class STEM mastery!',color:'#ffd700'};
  if(p>=75)return{grade:'A',msg:'ğŸ¯ Excellent! You truly know your subjects!',color:'#00ff88'};
  if(p>=60)return{grade:'B',msg:'ğŸ‘ Great job! Strong cross-disciplinary knowledge.',color:'#00d4ff'};
  if(p>=45)return{grade:'C',msg:'ğŸ“š Good effort. Keep reviewing each subject!',color:'#a0a0ff'};
  if(p>=30)return{grade:'D',msg:'ğŸ’ª Keep going. Consistent practice helps!',color:'#ff6b35'};
  return{grade:'F',msg:'ğŸ”„ Don\'t give up â€” review and try again!',color:'#ff2d55'};
}

function getGradeCSSClass(g){return'grade-'+g;}

function gradeChipHTML(grade){
  const colors={S:'#ffd700',A:'#00ff88',B:'#00d4ff',C:'#a0a0ff',D:'#ff6b35',F:'#ff2d55'};
  const c=colors[grade]||'#888';
  return `<span class="ac-grade" style="background:${c}22;border:1px solid ${c}66;color:${c};">${grade}</span>`;
}

// â”€â”€ ENTRY â”€â”€
function startQuiz(){
  const inp=document.getElementById('name-input');
  const name=inp.value.trim();
  if(!name){inp.style.borderColor='var(--wrong)';inp.focus();setTimeout(()=>inp.style.borderColor='',1200);return;}
  candidateName=name;currentSection=0;score=0;correctCount=0;wrongCount=0;skipCount=0;
  sectionResults=[];allQResults=[];
  currentAttemptId='ATT-'+Date.now().toString(36).toUpperCase();
  showSectionIntro();
}

function goBackToEntry(){
  showScreen('entry');renderLB('entry-lb-list',false);
}

// â”€â”€ SECTION INTRO â”€â”€
function showSectionIntro(){
  const sec=SECTIONS[currentSection];
  document.getElementById('intro-number').textContent=`SECTION ${currentSection+1} OF ${SECTIONS.length}`;
  document.getElementById('intro-name').textContent=`${sec.icon} ${sec.key.toUpperCase()}`;
  document.getElementById('intro-name').style.color=sec.color;
  document.getElementById('intro-name').style.textShadow=`0 0 30px ${sec.color}44`;
  document.getElementById('intro-desc').textContent=sec.desc;
  document.getElementById('intro-btn').textContent=currentSection===0?'Begin Quiz â–¶':`Begin ${sec.key} â–¶`;

  const dots=document.getElementById('intro-dots');
  dots.innerHTML=SECTIONS.map((s,i)=>{
    let cls='dot',style='';
    if(i<currentSection){cls+=' done';}
    if(i===currentSection){cls+=' active';style=`background:${s.color};box-shadow:0 0 14px ${s.color}`;}
    return `<div class="${cls}" style="${style}" title="${s.key}"></div>`;
  }).join('');
  showScreen('section-intro');
}

function startSection(){
  const pool=[...BANK[SECTIONS[currentSection].key]].sort(()=>Math.random()-.5);
  sectionQuestions=pool.slice(0,QPS);
  currentQ=0;sectionScore=0;sCorrect=0;sWrong=0;sSkip=0;
  showScreen('quiz');loadQuestion();
}

// â”€â”€ QUIZ â”€â”€
function loadQuestion(){
  answered=false;timeLeft=TIME;
  const sec=SECTIONS[currentSection];
  const qData=sectionQuestions[currentQ];
  const globalQ=currentSection*QPS+currentQ;

  document.getElementById('q-counter').textContent=`Q ${currentQ+1} / ${QPS}`;
  document.getElementById('quiz-section-label').textContent=`SECTION ${currentSection+1} / ${SECTIONS.length} Â· ${sec.key}`;
  const ctag=document.getElementById('category-tag');
  ctag.textContent=sec.key.toUpperCase();
  ctag.style.cssText=`color:${sec.color};border-color:${sec.color}40;background:${sec.color}14;`;

  updateScoreDisplay();
  document.getElementById('section-score-mini').textContent=`Section: ${sectionScore}/${QPS*PTS}`;

  const secPct=(currentQ/QPS)*100;
  const ovrPct=(globalQ/(SECTIONS.length*QPS))*100;
  const ps=document.getElementById('progress-section');
  ps.style.width=secPct+'%';
  ps.style.cssText+=`background:linear-gradient(90deg,${sec.color},${sec.color}88);box-shadow:0 0 8px ${sec.color}55;`;
  document.getElementById('progress-overall').style.width=ovrPct+'%';
  document.getElementById('sec-prog-lbl').textContent=Math.round(secPct)+'%';
  document.getElementById('ovr-prog-lbl').textContent=Math.round(ovrPct)+'%';

  document.getElementById('question-text').textContent=qData.q;

  const cont=document.getElementById('options-container');
  cont.innerHTML='';
  ['A','B','C'].forEach((l,i)=>{
    const btn=document.createElement('button');
    btn.className='option';
    btn.innerHTML=`<span class="opt-letter">${l}</span>${qData.opts[i]}`;
    btn.onclick=()=>selectAnswer(i);
    cont.appendChild(btn);
  });

  document.getElementById('feedback-strip').className='feedback-strip';
  document.getElementById('feedback-strip').textContent='';
  updateTimer();clearInterval(timerInterval);
  timerInterval=setInterval(tickTimer,1000);
}

function updateTimer(){
  const pct=timeLeft/TIME;
  const ring=document.getElementById('timer-ring-fill');
  const bar=document.getElementById('timer-bar-fill');
  ring.style.strokeDashoffset=163*(1-pct);
  bar.style.width=(pct*100)+'%';
  document.getElementById('timer-number').textContent=timeLeft;
  const num=document.getElementById('timer-number');
  ring.className='fill';
  if(timeLeft<=3){ring.classList.add('danger');bar.style.background='var(--wrong)';num.style.color='var(--wrong)';}
  else if(timeLeft<=5){ring.classList.add('warning');bar.style.background='var(--accent2)';num.style.color='var(--accent2)';}
  else{bar.style.background='var(--accent)';num.style.color='var(--text)';}
}

function tickTimer(){
  if(answered)return;
  timeLeft--;
  if(timeLeft<=5&&timeLeft>0)playSound('tick');
  updateTimer();
  if(timeLeft<=0){clearInterval(timerInterval);handleTimeout();}
}

function handleTimeout(){
  answered=true;sSkip++;skipCount++;
  const qData=sectionQuestions[currentQ];
  document.querySelectorAll('.option').forEach(o=>o.classList.add('disabled'));
  document.querySelectorAll('.option')[qData.ans].classList.add('correct');
  const fb=document.getElementById('feedback-strip');
  fb.className='feedback-strip timeout';
  fb.textContent=`â± Time's up! Correct: ${qData.opts[qData.ans]}`;
  playSound('timeout');
  allQResults.push({sec:SECTIONS[currentSection].key,q:qData.q,opts:qData.opts,ans:qData.ans,chosen:-1,result:'skip'});
  advance(2000);
}

function selectAnswer(chosen){
  if(answered)return;
  answered=true;clearInterval(timerInterval);
  const qData=sectionQuestions[currentQ];
  document.querySelectorAll('.option').forEach(o=>o.classList.add('disabled'));
  const fb=document.getElementById('feedback-strip');
  if(chosen===qData.ans){
    document.querySelectorAll('.option')[chosen].classList.add('correct');
    score+=PTS;sectionScore+=PTS;correctCount++;sCorrect++;
    fb.className='feedback-strip correct';fb.textContent=`âœ“ Correct! +${PTS} points`;
    playSound('correct');
    allQResults.push({sec:SECTIONS[currentSection].key,q:qData.q,opts:qData.opts,ans:qData.ans,chosen,result:'correct'});
  } else {
    document.querySelectorAll('.option')[chosen].classList.add('wrong');
    document.querySelectorAll('.option')[qData.ans].classList.add('correct');
    score-=PTS;sectionScore-=PTS;wrongCount++;sWrong++;
    fb.className='feedback-strip wrong';fb.textContent=`âœ— Wrong! -${PTS} points. Correct: ${qData.opts[qData.ans]}`;
    playSound('wrong');
    allQResults.push({sec:SECTIONS[currentSection].key,q:qData.q,opts:qData.opts,ans:qData.ans,chosen,result:'wrong'});
  }
  updateScoreDisplay();
  document.getElementById('section-score-mini').textContent=`Section: ${sectionScore}/${QPS*PTS}`;
  advance(2000);
}

function updateScoreDisplay(){
  const el=document.getElementById('score-display');
  el.textContent=(score>=0?'+':'')+score;
  el.className='score-display'+(score<0?' negative':'');
}

function advance(ms){setTimeout(()=>{currentQ++;if(currentQ>=QPS)endSection();else loadQuestion();},ms);}

// â”€â”€ QUIT â”€â”€
function confirmQuit(){openModal('modal-quit');}
function doQuit(){
  closeModal('modal-quit');
  clearInterval(timerInterval);
  // Record any unanswered questions as skips
  for(let i=currentQ;i<QPS;i++){
    const qData=sectionQuestions[i];
    if(qData)allQResults.push({sec:SECTIONS[currentSection].key,q:qData.q,opts:qData.opts,ans:qData.ans,chosen:-1,result:'skip'});
    skipCount++;
  }
  sectionResults.push({key:SECTIONS[currentSection].key,score:sectionScore,correct:sCorrect,wrong:sWrong,skip:QPS-sCorrect-sWrong,color:SECTIONS[currentSection].color});
  showToast('Quiz ended â€” score saved to leaderboard','warn');
  endQuiz(true);
}

// â”€â”€ SECTION END â”€â”€
function endSection(){
  clearInterval(timerInterval);
  const sec=SECTIONS[currentSection];
  playSound('section');
  sectionResults.push({key:sec.key,score:sectionScore,correct:sCorrect,wrong:sWrong,skip:sSkip,color:sec.color});

  document.getElementById('se-section-label').textContent=`${sec.icon} ${sec.key.toUpperCase()} â€” SECTION COMPLETE`;
  const se=document.getElementById('se-score');
  se.textContent=sectionScore;
  se.style.background=`linear-gradient(135deg,${sec.color},${sec.color}88)`;
  se.style.webkitBackgroundClip='text';se.style.webkitTextFillColor='transparent';se.style.backgroundClip='text';
  document.getElementById('se-score-label').textContent=`/ ${QPS*PTS} points`;
  document.getElementById('se-correct').textContent=sCorrect;
  document.getElementById('se-wrong').textContent=sWrong;
  document.getElementById('se-skip').textContent=sSkip;
  document.getElementById('se-total').textContent=(score>=0?'+':'')+score+' / '+(currentSection+1)*QPS*PTS;

  // Question review for this section
  const secQs=allQResults.filter(q=>q.sec===sec.key);
  const rev=document.getElementById('se-review-list');
  rev.innerHTML=secQs.map((r,i)=>{
    const cls=r.result==='correct'?'r-correct':r.result==='wrong'?'r-wrong':'r-skip';
    const icon=r.result==='correct'?'âœ“':r.result==='wrong'?'âœ—':'â€”';
    const ansText=r.result==='skip'?`Unanswered Â· Correct: ${r.opts[r.ans]}`
      :r.result==='correct'?`Correct: ${r.opts[r.ans]}`
      :`Your answer: ${r.opts[r.chosen]} Â· Correct: ${r.opts[r.ans]}`;
    return `<div class="q-review-item ${cls}">
      <div class="q-review-num">${icon} Q${i+1}</div>
      <div class="q-review-body">
        <div class="q-review-q">${r.q}</div>
        <div class="q-review-ans">${ansText}</div>
      </div>
    </div>`;
  }).join('');

  const nb=document.getElementById('se-next-btn');
  if(currentSection+1>=SECTIONS.length)nb.textContent='View Final Results â–¶';
  else nb.textContent=`${SECTIONS[currentSection+1].icon} Next: ${SECTIONS[currentSection+1].key} â–¶`;
  showScreen('section-end');
}

function nextSection(){
  currentSection++;
  if(currentSection>=SECTIONS.length)endQuiz(false);
  else showSectionIntro();
}

// â”€â”€ FINAL END â”€â”€
function endQuiz(early=false){
  const {grade,msg}=getGrade(score);
  document.getElementById('final-score-num').textContent=score;
  const badge=document.getElementById('grade-badge');
  badge.textContent=`GRADE ${grade}`;badge.className=`grade-badge ${getGradeCSSClass(grade)}`;
  document.getElementById('performance-msg').textContent=msg;
  document.getElementById('correct-count').textContent=correctCount;
  document.getElementById('wrong-count').textContent=wrongCount;
  document.getElementById('skip-count').textContent=skipCount;

  const bl=document.getElementById('breakdown-list');
  bl.innerHTML=sectionResults.map(r=>{
    const max=QPS*PTS;const pct=Math.max(0,r.score/max)*100;
    return `<div class="bk-row">
      <div class="bk-name">${SECTIONS.find(s=>s.key===r.key)?.icon||''} ${r.key}</div>
      <div class="bk-bar-wrap"><div class="bk-bar" style="width:${pct}%;background:linear-gradient(90deg,${r.color},${r.color}88)"></div></div>
      <div class="bk-score" style="color:${r.color}">${r.score}/${max}</div>
    </div>`;
  }).join('');

  const accuracy=Math.round((correctCount/(SECTIONS.length*QPS))*100);

  // Save attempt
  const attempt={
    id:currentAttemptId,
    name:candidateName,
    score,grade,
    correct:correctCount,wrong:wrongCount,skip:skipCount,
    accuracy,
    sectionResults:JSON.parse(JSON.stringify(sectionResults)),
    allQResults:JSON.parse(JSON.stringify(allQResults)),
    date:new Date().toLocaleDateString(),
    dateISO:new Date().toISOString(),
    early
  };
  leaderboard.push(attempt);
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard=leaderboard.slice(0,20);
  try{localStorage.setItem('stemLB4',JSON.stringify(leaderboard));}catch(e){}

  renderLB('end-lb-list',true);
  renderLB('entry-lb-list',false);

  populateCertificate(attempt);
  showScreen('end');
  if(!early)showToast('Quiz complete! Score saved.','success');
}

// â”€â”€ CERTIFICATE â”€â”€
function populateCertificate(a){
  document.getElementById('cert-name').textContent=a.name;
  document.getElementById('cert-score').textContent=a.score;
  const g=document.getElementById('cert-grade-circle');
  g.textContent=a.grade;
  const gColors={S:'#ffd700',A:'#00ff88',B:'#00d4ff',C:'#a0a0ff',D:'#ff6b35',F:'#ff2d55'};
  g.style.background=`linear-gradient(135deg,${gColors[a.grade]||'#888'},${gColors[a.grade]||'#888'}88)`;
  document.getElementById('cert-accuracy').textContent=a.accuracy+'%';
  document.getElementById('cert-correct').textContent=`${a.correct}/50`;
  // Percentile estimate
  const pct=Math.round((a.score/100)*100);
  const perc=pct>=90?'Top 5%':pct>=75?'Top 15%':pct>=60?'Top 30%':pct>=45?'Top 50%':pct>=30?'Top 70%':'Bottom 30%';
  document.getElementById('cert-percentile').textContent=perc;
  document.getElementById('cert-date').textContent=new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  const certId='STEM-'+a.id;
  document.getElementById('cert-id').textContent=certId;
  document.getElementById('cert-id-display').textContent='ID: '+a.id;

  // Section mini bars
  const srow=document.getElementById('cert-sections-row');
  const secColors=['#00d4ff','#7fff00','#ff6b35','#ff2d55','#ffd700'];
  const allSecs=SECTIONS.map(s=>a.sectionResults.find(r=>r.key===s.key)||{key:s.key,score:0});
  srow.innerHTML=allSecs.map((r,i)=>{
    const max=QPS*PTS;const pct=Math.max(0,r.score/max);
    const barH=Math.round(pct*28)+4;
    const c=secColors[i];
    return `<div class="cert-sec-item">
      <div class="cert-sec-bar-outer">
        <div class="cert-sec-bar-fill" style="height:${barH}px;background:${c};opacity:.85;"></div>
      </div>
      <div class="cert-sec-val" style="color:${c}">${r.score}/${max}</div>
      <div class="cert-sec-label">${SECTIONS[i].key.substring(0,4)}</div>
    </div>`;
  }).join('');
}

function printCertificate(){
  document.getElementById('certificate-wrap').style.display='block';
  setTimeout(()=>{window.print();setTimeout(()=>{document.getElementById('certificate-wrap').style.display='none';},500);},300);
}

// â”€â”€ ANALYTICS â”€â”€
function showAnalytics(attempt=null){
  const a=attempt||leaderboard.find(e=>e.name===candidateName&&e.score===score)||leaderboard[0];
  if(!a)return;
  document.getElementById('analytics-title').textContent=`ğŸ“Š Analytics â€” ${a.name}`;
  document.getElementById('an-score').textContent=a.score;
  const ab=document.getElementById('an-grade-badge');
  ab.textContent=`GRADE ${a.grade}`;ab.className=`grade-badge ${getGradeCSSClass(a.grade)}`;
  document.getElementById('an-meta').innerHTML=`${a.date}<br>Accuracy: ${a.accuracy}%<br>Correct: ${a.correct}/50`;

  const bars=document.getElementById('an-section-bars');
  bars.innerHTML=(a.sectionResults||[]).map(r=>{
    const max=QPS*PTS;const pct=Math.max(0,r.score/max)*100;
    const sec=SECTIONS.find(s=>s.key===r.key);
    return `<div class="sbar-row">
      <div class="sbar-name">${sec?.icon||''} ${r.key}</div>
      <div class="sbar-outer"><div class="sbar-fill" style="width:${pct}%;background:linear-gradient(90deg,${r.color},${r.color}88);"></div></div>
      <div class="sbar-val" style="color:${r.color}">${r.score}/${max}</div>
    </div>`;
  }).join('');

  // Draw simple bar chart on canvas
  setTimeout(()=>{
    const canvas=document.getElementById('an-canvas');
    const ctx=canvas.getContext('2d');
    canvas.width=canvas.offsetWidth*2;canvas.height=120*2;
    ctx.scale(2,2);
    const W=canvas.offsetWidth/2,H=60;
    ctx.clearRect(0,0,W,H*2);
    ctx.fillStyle='rgba(26,45,74,.5)';ctx.fillRect(0,0,W,H*2);

    const labels=['Correct','Wrong','Skipped'];
    const vals=[a.correct||0,a.wrong||0,a.skip||0];
    const colors=['#00ff88','#ff2d55','#ff6b35'];
    const total=50;
    const barW=(W-80)/3;
    labels.forEach((l,i)=>{
      const x=40+i*(barW+10);
      const h=(vals[i]/total)*(H-20);
      ctx.fillStyle=colors[i]+'33';ctx.fillRect(x,H-h,barW,h);
      ctx.fillStyle=colors[i];ctx.fillRect(x,H-h,barW,3);
      ctx.fillStyle=colors[i];ctx.font='bold 11px Orbitron,monospace';ctx.textAlign='center';
      ctx.fillText(vals[i],x+barW/2,H-h-4);
      ctx.fillStyle='rgba(200,220,255,.5)';ctx.font='9px Rajdhani,sans-serif';
      ctx.fillText(l,x+barW/2,H+14);
    });
  },100);

  openModal('modal-analytics');
}

// â”€â”€ REVIEW ATTEMPT â”€â”€
function reviewAttempt(idx){
  const a=leaderboard[idx];if(!a)return;
  document.getElementById('review-title').textContent=`ğŸ“‹ ${a.name}'s Attempt â€” ${a.date}`;

  const rb=document.getElementById('review-cert-btn');
  rb.onclick=()=>{populateCertificate(a);closeModal('modal-review');printCertificate();};

  let html=`<div class="analytics-score-row" style="margin-bottom:14px;">
    <div><div class="analytics-big-score" style="font-size:1.8rem;">${a.score}</div><div style="font-size:.65rem;color:var(--muted);letter-spacing:2px;">SCORE</div></div>
    <div id="" class="grade-badge ${getGradeCSSClass(a.grade)}">${a.grade}</div>
    <div style="text-align:right;font-size:.75rem;color:var(--muted);line-height:1.8;">${a.date}<br>Accuracy: ${a.accuracy}%<br>Correct: ${a.correct}/50</div>
  </div>`;

  html+=`<div style="font-family:'Orbitron',monospace;font-size:.62rem;letter-spacing:3px;color:var(--muted);text-transform:uppercase;margin-bottom:8px;">Section Scores</div>`;
  html+=(a.sectionResults||[]).map(r=>{
    const max=QPS*PTS;const pct=Math.max(0,r.score/max)*100;
    const sec=SECTIONS.find(s=>s.key===r.key);
    return `<div class="sbar-row" style="margin-bottom:7px;">
      <div class="sbar-name">${sec?.icon||''} ${r.key}</div>
      <div class="sbar-outer" style="height:6px;"><div class="sbar-fill" style="width:${pct}%;background:${r.color};"></div></div>
      <div class="sbar-val" style="color:${r.color}">${r.score}/${max}</div>
    </div>`;
  }).join('');

  if(a.allQResults&&a.allQResults.length){
    html+=`<div style="font-family:'Orbitron',monospace;font-size:.62rem;letter-spacing:3px;color:var(--muted);text-transform:uppercase;margin:12px 0 8px;">All Questions</div>`;
    html+=`<div class="q-review-list" style="max-height:260px;">`;
    html+=a.allQResults.map((r,i)=>{
      const cls=r.result==='correct'?'r-correct':r.result==='wrong'?'r-wrong':'r-skip';
      const icon=r.result==='correct'?'âœ“':r.result==='wrong'?'âœ—':'â€”';
      const ans=r.result==='skip'?`Unanswered Â· Correct: ${r.opts[r.ans]}`
        :r.result==='correct'?`Correct: ${r.opts[r.ans]}`
        :`Your: ${r.opts[r.chosen]} Â· Correct: ${r.opts[r.ans]}`;
      return `<div class="q-review-item ${cls}">
        <div class="q-review-num">${icon} Q${i+1}</div>
        <div class="q-review-body"><div class="q-review-q">${r.q}</div><div class="q-review-ans">${ans}</div></div>
      </div>`;
    }).join('');
    html+=`</div>`;
  }
  document.getElementById('review-content').innerHTML=html;
  openModal('modal-review');
}

// â”€â”€ LEADERBOARD â”€â”€
function renderLB(id,mark){
  const el=document.getElementById(id);if(!el)return;
  if(!leaderboard.length){el.innerHTML='<div style="color:var(--muted);font-size:.88rem;text-align:center;padding:14px;">No sessions yet</div>';return;}
  const em=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'],cl=['gold','silver','bronze'];
  el.innerHTML=leaderboard.map((e,i)=>{
    const cur=mark&&e.name===candidateName&&e.score===score;
    return `<div class="lb-entry clickable${cur?' current':''}" onclick="reviewAttempt(${i})" title="Click to review attempt">
      <div class="lb-rank ${cl[i]||''}">${i<3?em[i]:'#'+(i+1)}</div>
      <div class="lb-name">${e.name}${cur?' â—€ YOU':''}</div>
      <div>${gradeChipHTML(e.grade)}</div>
      <div class="lb-score">${e.score>=0?'+':''}${e.score}</div>
      <div class="lb-date">${e.date||''}</div>
    </div>`;
  }).join('');
}

function restartQuiz(){
  document.getElementById('name-input').value='';
  showScreen('entry');renderLB('entry-lb-list',false);
}

// Close modals on overlay click
document.querySelectorAll('.modal-overlay').forEach(o=>{
  o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('open');});
});

// Enter key
document.getElementById('name-input').addEventListener('keydown',e=>{if(e.key==='Enter')startQuiz();});

// Init
renderLB('entry-lb-list',false);
</script>

</body>
</html>
